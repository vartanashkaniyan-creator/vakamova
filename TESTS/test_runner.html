<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ØªØ³Øª Vakamova</title>
    <style>
        :root {
            --primary: #0d7377;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #f44336;
            --dark: #1a1a2e;
            --light: #f8f9fa;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        h1 {
            color: #64ffda;
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #8892b0;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0d7377 0%, #14ffec 100%);
            color: #000;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(13, 115, 119, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2e7d32 0%, #4CAF50 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f57c00 0%, #FF9800 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #c62828 0%, #f44336 100%);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .module-card {
            background: rgba(17, 34, 64, 0.7);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(100, 255, 218, 0.2);
            transition: all 0.3s;
        }
        
        .module-card:hover {
            border-color: rgba(100, 255, 218, 0.5);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }
        
        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .module-title {
            color: #64ffda;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .module-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .badge-core { background: #0d7377; color: white; }
        .badge-auth { background: #9C27B0; color: white; }
        .badge-lesson { background: #2196F3; color: white; }
        .badge-ui { background: #FF9800; color: black; }
        .badge-page { background: #4CAF50; color: white; }
        
        .module-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #666;
        }
        
        .status-pending { background: #FF9800; }
        .status-loaded { background: #4CAF50; }
        .status-error { background: #f44336; }
        .status-testing { background: #2196F3; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        .module-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .module-action-btn {
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .module-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .module-action-btn.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }
        
        .module-action-btn.warning {
            background: rgba(255, 152, 0, 0.2);
            color: #FF9800;
        }
        
        .module-action-btn.danger {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .module-info {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: #8892b0;
        }
        
        .log-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .log-filters {
            display: flex;
            gap: 10px;
        }
        
        .log-filter-btn {
            padding: 6px 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #8892b0;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .log-filter-btn.active {
            background: rgba(100, 255, 218, 0.2);
            color: #64ffda;
            border-color: #64ffda;
        }
        
        .log-entry {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .log-entry.success { color: #4CAF50; border-left: 4px solid #4CAF50; padding-left: 15px; }
        .log-entry.error { color: #f44336; border-left: 4px solid #f44336; padding-left: 15px; }
        .log-entry.info { color: #64b5f6; border-left: 4px solid #64b5f6; padding-left: 15px; }
        .log-entry.warning { color: #FF9800; border-left: 4px solid #FF9800; padding-left: 15px; }
        
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #8892b0;
            font-size: 0.9rem;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0d7377, #14ffec);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .module-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§ª Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ØªØ³Øª Vakamova</h1>
            <p class="subtitle">Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø¢Ø²Ù…Ø§ÛŒØ´ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ø¬Ø²Ø§ Ùˆ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡</p>
            
            <div class="control-panel">
                <button class="btn btn-primary" onclick="loadAllModules()">
                    <span>ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</span>
                </button>
                <button class="btn btn-success" onclick="runAllTests()">
                    <span>âš¡ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§</span>
                </button>
                <button class="btn btn-warning" onclick="runIntegrationTest()">
                    <span>ğŸ”— ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ú©Ø§Ù…Ù„</span>
                </button>
                <button class="btn btn-danger" onclick="clearAllModules()">
                    <span>ğŸ—‘ï¸ Ø®Ø§Ù„ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù‡Ù…Ù‡</span>
                </button>
            </div>
        </header>
        
        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-label">Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡</div>
                <div class="stat-value" id="loadedCount">0</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="loadedProgress"></div>
                </div>
                <div class="stat-label" id="loadedPercentage">0%</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚</div>
                <div class="stat-value" id="passedCount">0</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚</div>
                <div class="stat-value" id="failedCount">0</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</div>
                <div class="stat-value" id="totalTests">0</div>
            </div>
        </div>
        
        <div class="dashboard" id="modulesDashboard">
            <!-- Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§ÛŒÙ†Ø¬Ø§ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
        
        <div class="log-container">
            <div class="log-header">
                <h3>ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ø§Ø¬Ø±Ø§</h3>
                <div class="log-filters">
                    <button class="log-filter-btn active" onclick="filterLogs('all')">Ù‡Ù…Ù‡</button>
                    <button class="log-filter-btn" onclick="filterLogs('success')">Ù…ÙˆÙÙ‚</button>
                    <button class="log-filter-btn" onclick="filterLogs('error')">Ø®Ø·Ø§</button>
                    <button class="log-filter-btn" onclick="filterLogs('warning')">Ù‡Ø´Ø¯Ø§Ø±</button>
                    <button class="log-filter-btn" onclick="clearLogs()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†</button>
                </div>
            </div>
            <div id="logEntries">
                <!-- Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>
    </div>
    
    <script>
        // ==================== Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ ====================
        const PROJECT_MODULES = [
            // Ù‡Ø³ØªÙ‡ Ø§ØµÙ„ÛŒ
            { name: 'Event Bus', path: 'core/event_bus.js', type: 'core', badge: 'badge-core' },
            { name: 'State Manager', path: 'core/state_manager.js', type: 'core', badge: 'badge-core' },
            { name: 'Context Provider', path: 'core/context_provider.js', type: 'core', badge: 'badge-core' },
            { name: 'API Client', path: 'core/api_client.js', type: 'core', badge: 'badge-core' },
            { name: 'Router Middleware', path: 'core/router_middleware.js', type: 'core', badge: 'badge-core' },
            { name: 'Guards', path: 'core/guards.js', type: 'core', badge: 'badge-core' },
            
            // Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…ÛŒ
            { name: 'Auth Manager', path: 'modules/auth/auth_manager.js', type: 'auth', badge: 'badge-auth' },
            { name: 'Token Manager', path: 'modules/auth/token_manager.js', type: 'auth', badge: 'badge-auth' },
            { name: 'Auth Middleware', path: 'modules/auth/auth_middleware.js', type: 'auth', badge: 'badge-auth' },
            { name: 'Lesson Engine', path: 'modules/lessons/engine.js', type: 'lesson', badge: 'badge-lesson' },
            { name: 'Button Component', path: 'components/Button.js', type: 'ui', badge: 'badge-ui' },
            { name: 'Card Component', path: 'components/Card.js', type: 'ui', badge: 'badge-ui' },
            
            // ØµÙØ­Ø§Øª
            { name: 'Auth View', path: 'pages/auth/auth_view.js', type: 'page', badge: 'badge-page' },
            { name: 'Home Page', path: 'pages/home/home_page.js', type: 'page', badge: 'badge-page' },
            { name: 'Router', path: 'pages/router.js', type: 'page', badge: 'badge-page' }
        ];
        
        // ==================== ÙˆØ¶Ø¹ÛŒØª Ø¨Ø±Ù†Ø§Ù…Ù‡ ====================
        const appState = {
            modules: new Map(),
            logs: [],
            stats: {
                loaded: 0,
                passed: 0,
                failed: 0,
                total: 0
            }
        };
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ ====================
        function log(message, type = 'info', module = 'system') {
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const logEntry = {
                id: `log_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                message,
                type,
                timestamp,
                module,
                visible: true
            };
            
            appState.logs.unshift(logEntry);
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ØµÙØ­Ù‡
            const logElement = document.createElement('div');
            logElement.className = `log-entry ${type}`;
            logElement.id = logEntry.id;
            logElement.innerHTML = `
                <strong>[${timestamp}]</strong> 
                <span class="log-module">[${module}]</span>
                <span>${message}</span>
            `;
            
            document.getElementById('logEntries').prepend(logElement);
            console.log(`[${type.toUpperCase()}] [${module}] ${message}`);
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
            updateStats();
            
            return logEntry.id;
        }
        
        function filterLogs(filter) {
            const buttons = document.querySelectorAll('.log-filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            appState.logs.forEach(log => {
                const element = document.getElementById(log.id);
                if (element) {
                    log.visible = filter === 'all' || log.type === filter;
                    element.style.display = log.visible ? 'block' : 'none';
                }
            });
        }
        
        function clearLogs() {
            document.getElementById('logEntries').innerHTML = '';
            appState.logs = [];
            log('Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'info');
        }
        
        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ ====================
        function initializeDashboard() {
            const dashboard = document.getElementById('modulesDashboard');
            dashboard.innerHTML = '';
            
            PROJECT_MODULES.forEach((module, index) => {
                const moduleState = {
                    id: `module_${index}`,
                    name: module.name,
                    path: module.path,
                    type: module.type,
                    badge: module.badge,
                    status: 'pending', // pending, loaded, error, testing
                    instance: null,
                    loadTime: null,
                    testResult: null
                };
                
                appState.modules.set(module.name, moduleState);
                
                const card = document.createElement('div');
                card.className = 'module-card';
                card.id = moduleState.id;
                card.innerHTML = `
                    <div class="module-header">
                        <div class="module-title">
                            <span class="module-icon">${getModuleIcon(module.type)}</span>
                            <span>${module.name}</span>
                        </div>
                        <span class="module-badge ${module.badge}">${module.type}</span>
                    </div>
                    
                    <div class="module-status">
                        <div class="status-indicator status-pending" id="status_${module.name}"></div>
                        <span id="statusText_${module.name}">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ</span>
                    </div>
                    
                    <div class="module-info">
                        <div>Ù…Ø³ÛŒØ±: <code>${module.path}</code></div>
                        <div id="info_${module.name}">Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ</div>
                    </div>
                    
                    <div class="module-actions">
                        <button class="module-action-btn" onclick="loadModule('${module.name}')" id="loadBtn_${module.name}">
                            ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                        </button>
                        <button class="module-action-btn success" onclick="testModule('${module.name}')" id="testBtn_${module.name}" disabled>
                            âš¡ ØªØ³Øª ÙˆØ§Ø­Ø¯
                        </button>
                        <button class="module-action-btn danger" onclick="clearModule('${module.name}')" id="clearBtn_${module.name}" disabled>
                            ğŸ—‘ï¸ Ø®Ø§Ù„ÛŒâ€ŒØ³Ø§Ø²ÛŒ
                        </button>
                    </div>
                `;
                
                dashboard.appendChild(card);
            });
            
            updateStats();
            log('Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ØªØ³Øª Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯', 'success');
        }
        
        async function loadModule(moduleName) {
            const moduleState = appState.modules.get(moduleName);
            if (!moduleState) return;
            
            moduleState.status = 'testing';
            updateModuleUI(moduleName);
            
            try {
                log(`Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ${moduleName}...`, 'info', moduleName);
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª
                const script = document.createElement('script');
                script.src = moduleState.path;
                script.type = 'module';
                
                await new Promise((resolve, reject) => {
                    script.onload = () => {
                        moduleState.status = 'loaded';
                        moduleState.loadTime = Date.now();
                        moduleState.instance = window[moduleName] || null;
                        
                        // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ ØªØ³Øª
                        document.getElementById(`testBtn_${moduleName}`).disabled = false;
                        document.getElementById(`clearBtn_${moduleName}`).disabled = false;
                        
                        log(`âœ… ${moduleName} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`, 'success', moduleName);
                        resolve();
                    };
                    
                    script.onerror = () => {
                        moduleState.status = 'error';
                        log(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ${moduleName}`, 'error', moduleName);
                        reject(new Error(`Failed to load ${moduleName}`));
                    };
                    
                    document.head.appendChild(script);
                });
                
                // ØªØ³Øª Ø§ÙˆÙ„ÛŒÙ‡ Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                if (moduleState.instance) {
                    try {
                        await testModule(moduleName, true);
                    } catch (testError) {
                        // ØªØ³Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ù†ÛŒØ³Øª
                    }
                }
                
            } catch (error) {
                moduleState.status = 'error';
                log(`Ø®Ø·Ø§: ${error.message}`, 'error', moduleName);
            } finally {
                updateModuleUI(moduleName);
                updateStats();
            }
        }
        
        async function testModule(moduleName, silent = false) {
            const moduleState = appState.modules.get(moduleName);
            if (!moduleState || moduleState.status !== 'loaded') {
                if (!silent) log(`Ø§Ø¨ØªØ¯Ø§ ${moduleName} Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯`, 'warning', moduleName);
                return;
            }
            
            moduleState.status = 'testing';
            updateModuleUI(moduleName);
            
            if (!silent) log(`Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª ${moduleName}...`, 'info', moduleName);
            
            try {
                const testResult = await executeModuleTest(moduleName, moduleState);
                
                if (testResult.success) {
                    moduleState.status = 'loaded';
                    moduleState.testResult = 'passed';
                    appState.stats.passed++;
                    if (!silent) log(`âœ… ØªØ³Øª ${moduleName} Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯`, 'success', moduleName);
                } else {
                    moduleState.status = 'error';
                    moduleState.testResult = 'failed';
                    appState.stats.failed++;
                    if (!silent) log(`âŒ ØªØ³Øª ${moduleName} Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯: ${testResult.error}`, 'error', moduleName);
                }
                
                appState.stats.total++;
                
            } catch (error) {
                moduleState.status = 'error';
                moduleState.testResult = 'failed';
                appState.stats.failed++;
                appState.stats.total++;
                
                if (!silent) log(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª ${moduleName}: ${error.message}`, 'error', moduleName);
            } finally {
                updateModuleUI(moduleName);
                updateStats();
            }
        }
        
        async function executeModuleTest(moduleName, moduleState) {
            // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø§Ú˜ÙˆÙ„
            switch (moduleName) {
                case 'Event Bus':
                    if (typeof eventBus !== 'undefined') {
                        eventBus.emit('test:event', { test: true });
                        return { success: true };
                    }
                    break;
                    
                case 'State Manager':
                    if (typeof HyperStateManager !== 'undefined') {
                        const testState = new HyperStateManager(eventBus || { emit: () => {} });
                        testState.set('test', 'value');
                        return { success: testState.get('test') === 'value' };
                    }
                    break;
                    
                case 'Button Component':
                    if (typeof VakamovaButton !== 'undefined') {
                        const btn = new VakamovaButton({ eventBus: eventBus || { emit: () => {} } });
                        return { success: typeof btn.render === 'function' };
                    }
                    break;
                    
                case 'Auth Manager':
                    if (typeof auth_manager !== 'undefined') {
                        return { success: typeof auth_manager.register === 'function' };
                    }
                    break;
                    
                default:
                    // ØªØ³Øª Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
                    if (moduleState.instance) {
                        return { success: true, message: 'Ù…Ø§Ú˜ÙˆÙ„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯' };
                    }
            }
            
            return { success: false, error: 'Ù…Ø§Ú˜ÙˆÙ„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ø´Ø¯' };
        }
        
        function clearModule(moduleName) {
            const moduleState = appState.modules.get(moduleName);
            if (!moduleState) return;
            
            // Ø­Ø°Ù Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø² DOM
            const scripts = document.querySelectorAll(`script[src="${moduleState.path}"]`);
            scripts.forEach(script => script.remove());
            
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª
            moduleState.status = 'pending';
            moduleState.instance = null;
            moduleState.loadTime = null;
            moduleState.testResult = null;
            
            // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.getElementById(`testBtn_${moduleName}`).disabled = true;
            document.getElementById(`clearBtn_${moduleName}`).disabled = true;
            
            updateModuleUI(moduleName);
            log(`Ù…Ø§Ú˜ÙˆÙ„ ${moduleName} Ø®Ø§Ù„ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯`, 'warning', moduleName);
            updateStats();
        }
        
        function updateModuleUI(moduleName) {
            const moduleState = appState.modules.get(moduleName);
            if (!moduleState) return;
            
            const statusIndicator = document.getElementById(`status_${moduleName}`);
            const statusText = document.getElementById(`statusText_${moduleName}`);
            const infoText = document.getElementById(`info_${moduleName}`);
            const loadBtn = document.getElementById(`loadBtn_${moduleName}`);
            
            if (!statusIndicator || !statusText) return;
            
            // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª
            statusIndicator.className = 'status-indicator';
            
            switch (moduleState.status) {
                case 'pending':
                    statusIndicator.classList.add('status-pending');
                    statusText.textContent = 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
                    loadBtn.textContent = 'ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
                    break;
                    
                case 'testing':
                    statusIndicator.classList.add('status-testing');
                    statusText.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
                    loadBtn.textContent = 'â³ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
                    break;
                    
                case 'loaded':
                    statusIndicator.classList.add('status-loaded');
                    statusText.textContent = 'Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡' + 
                        (moduleState.testResult === 'passed' ? ' (ØªØ³Øª Ù…ÙˆÙÙ‚)' : 
                         moduleState.testResult === 'failed' ? ' (ØªØ³Øª Ù†Ø§Ù…ÙˆÙÙ‚)' : '');
                    loadBtn.textContent = 'âœ… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯';
                    break;
                    
                case 'error':
                    statusIndicator.classList.add('status-error');
                    statusText.textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
                    loadBtn.textContent = 'ğŸ”„ ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯';
                    break;
            }
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª
            if (infoText) {
                let info = '';
                if (moduleState.loadTime) {
                    const loadTime = new Date(moduleState.loadTime).toLocaleTimeString('fa-IR');
                    info += `Ø²Ù…Ø§Ù† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ: ${loadTime}<br>`;
                }
                if (moduleState.instance) {
                    info += `Ù†ÙˆØ¹: ${typeof moduleState.instance}<br>`;
                }
                infoText.innerHTML = info || 'Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
            }
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
        function getModuleIcon(type) {
            const icons = {
                core: 'âš™ï¸',
                auth: 'ğŸ”',
                lesson: 'ğŸ“š',
                ui: 'ğŸ¨',
                page: 'ğŸ“„'
            };
            return icons[type] || 'ğŸ“¦';
        }
        
        async function loadAllModules() {
            log('Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§...', 'info');
            
            for (const [name, module] of appState.modules) {
                if (module.status === 'pending') {
                    await loadModule(name);
                    // ØªØ£Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ø¨ÛŒÙ† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
            }
            
            log('Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯', 'success');
        }
        
        async function runAllTests() {
            log('Ø´Ø±ÙˆØ¹ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§...', 'info');
            
            for (const [name, module] of appState.modules) {
                if (module.status === 'loaded') {
                    await testModule(name);
                    // ØªØ£Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ø¨ÛŒÙ† ØªØ³Øªâ€ŒÙ‡Ø§
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
            }
            
            log('Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯', 'success');
        }
        
        async function runIntegrationTest() {
            log('Ø´Ø±ÙˆØ¹ ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ú©Ø§Ù…Ù„...', 'info');
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø§Ú¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯
            const essentialModules = ['Event Bus', 'State Manager', 'Auth Manager', 'Router'];
            for (const moduleName of essentialModules) {
                const module = appState.modules.get(moduleName);
                if (module && module.status === 'pending') {
                    await loadModule(moduleName);
                }
            }
            
            // ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø±
            try {
                // Û±. ØªØ³Øª Event Bus
                if (typeof eventBus !== 'undefined') {
                    let eventReceived = false;
                    eventBus.on('integration:test', () => eventReceived = true);
                    eventBus.emit('integration:test', { data: 'test' });
                    
                    if (eventReceived) {
                        log('âœ… Event Bus Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø±Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', 'success');
                    }
                }
                
                // Û². ØªØ³Øª State Manager
                if (typeof HyperStateManager !== 'undefined') {
                    const testState = new HyperStateManager(eventBus || { emit: () => {} });
                    testState.set('integration.test', 'working');
                    
                    if (testState.get('integration.test') === 'working') {
                        log('âœ… State Manager Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', 'success');
                    }
                }
                
                // Û³. ØªØ³Øª Auth (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯)
                if (typeof auth_manager !== 'undefined') {
                    log('âœ… Ø³ÛŒØ³ØªÙ… Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª', 'success');
                }
                
                // Û´. ØªØ³Øª Button Component (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯)
                if (typeof VakamovaButton !== 'undefined') {
                    log('âœ… Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Button Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª', 'success');
                }
                
                log('ğŸ‰ ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡: ${error.message}`, 'error');
            }
        }
        
        function clearAllModules() {
            for (const [name] of appState.modules) {
                clearModule(name);
            }
            
            appState.stats = { loaded: 0, passed: 0, failed: 0, total: 0 };
            updateStats();
            log('Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ø®Ø§Ù„ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù†Ø¯', 'warning');
        }
        
        function updateStats() {
            // Ø´Ù…Ø§Ø±Ø´ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡
            let loadedCount = 0;
            for (const [, module] of appState.modules) {
                if (module.status === 'loaded') loadedCount++;
            }
            
            appState.stats.loaded = loadedCount;
            
            // Ø¢Ù¾Ø¯ÛŒØª UI
            document.getElementById('loadedCount').textContent = loadedCount;
            document.getElementById('passedCount').textContent = appState.stats.passed;
            document.getElementById('failedCount').textContent = appState.stats.failed;
            document.getElementById('totalTests').textContent = appState.stats.total;
            
            // Ù¾ÛŒØ´Ø±ÙØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
            const progress = (loadedCount / PROJECT_MODULES.length) * 100;
            document.getElementById('loadedProgress').style.width = `${progress}%`;
            document.getElementById('loadedPercentage').textContent = `${Math.round(progress)}%`;
        }
        
        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
        window.addEventListener('DOMContentLoaded', () => {
            initializeDashboard();
            log('Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ØªØ³Øª Vakamova Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª', 'success');
            log(`ØªØ¹Ø¯Ø§Ø¯ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§: ${PROJECT_MODULES.length}`, 'info');
        });
        
        // Ø§Ú©Ø³Ù¾ÙˆØ±Øª ØªÙˆØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¯Ø³ØªÛŒ Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„
        window.VakamovaTester = {
            loadModule,
            testModule,
            clearModule,
            loadAllModules,
            runAllTests,
            runIntegrationTest,
            clearAllModules,
            log,
            getState: () => ({ 
                modules: Object.fromEntries(appState.modules),
                stats: appState.stats,
                logs: appState.logs 
            })
        };
    </script>
</body>
</html>
