<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª ØªØ³ØªØ± Ù¾ÙˆÛŒØ§ Vakamova</title>
    <style>
        :root {
            --primary: #0d7377;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #f44336;
            --dark: #1a1a2e;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 1400px; margin: 0 auto; }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        h1 { color: #64ffda; font-size: 2.5rem; margin-bottom: 10px; }
        .subtitle { color: #8892b0; font-size: 1.1rem; margin-bottom: 20px; }
        
        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary { background: linear-gradient(135deg, #0d7377 0%, #14ffec 100%); color: #000; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 7px 15px rgba(13, 115, 119, 0.4); }
        .btn-success { background: linear-gradient(135deg, #2e7d32 0%, #4CAF50 100%); color: white; }
        .btn-warning { background: linear-gradient(135deg, #f57c00 0%, #FF9800 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #c62828 0%, #f44336 100%); color: white; }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }
        
        .category-section { margin-bottom: 40px; }
        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(100, 255, 218, 0.3);
        }
        
        .category-title {
            font-size: 1.5rem;
            color: #64ffda;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            background: var(--primary);
            color: white;
        }
        
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .module-card {
            background: rgba(17, 34, 64, 0.7);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(100, 255, 218, 0.2);
            transition: all 0.3s;
        }
        
        .module-card:hover {
            border-color: rgba(100, 255, 218, 0.5);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .module-name {
            font-weight: bold;
            color: #fff;
            font-size: 1.1rem;
        }
        
        .module-path {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #8892b0;
            margin: 5px 0;
            word-break: break-all;
        }
        
        .module-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 12px 0;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #666;
        }
        
        .status-pending { background: #FF9800; }
        .status-loaded { background: #4CAF50; }
        .status-error { background: #f44336; }
        .status-testing { background: #2196F3; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        .status-text { font-size: 0.9rem; color: #aaa; }
        
        .module-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 15px;
        }
        
        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .action-btn.load { background: rgba(13, 115, 119, 0.3); color: #14ffec; }
        .action-btn.test { background: rgba(76, 175, 80, 0.3); color: #4CAF50; }
        .action-btn.clear { background: rgba(244, 67, 54, 0.3); color: #f44336; }
        
        .log-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .log-entry {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }
        
        .log-entry.success { color: #4CAF50; border-left: 4px solid #4CAF50; padding-left: 15px; }
        .log-entry.error { color: #f44336; border-left: 4px solid #f44336; padding-left: 15px; }
        .log-entry.info { color: #64b5f6; border-left: 4px solid #64b5f6; padding-left: 15px; }
        .log-entry.warning { color: #FF9800; border-left: 4px solid #FF9800; padding-left: 15px; }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #8892b0;
        }
        
        @media (max-width: 768px) {
            .modules-grid { grid-template-columns: 1fr; }
            .control-panel { grid-template-columns: 1fr; }
            .module-actions { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§ª ØªØ³ØªØ± Ù¾ÙˆÛŒØ§ Vakamova</h1>
            <p class="subtitle">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ø§Ø² ÙØ§ÛŒÙ„ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ</p>
            
            <div class="control-panel">
                <button class="btn btn-primary" onclick="loadConfig()">
                    <span>ğŸ”„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Config</span>
                </button>
                <button class="btn btn-success" onclick="loadAllModules()">
                    <span>ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡</span>
                </button>
                <button class="btn btn-warning" onclick="testAllModules()">
                    <span>âš¡ ØªØ³Øª Ù‡Ù…Ù‡</span>
                </button>
                <button class="btn btn-danger" onclick="clearAll()">
                    <span>ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡</span>
                </button>
            </div>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalModules">0</div>
                    <div class="stat-label">Ú©Ù„ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="loadedModules">0</div>
                    <div class="stat-label">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="passedTests">0</div>
                    <div class="stat-label">ØªØ³Øª Ù…ÙˆÙÙ‚</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="failedTests">0</div>
                    <div class="stat-label">ØªØ³Øª Ù†Ø§Ù…ÙˆÙÙ‚</div>
                </div>
            </div>
        </header>
        
        <div id="categoriesContainer">
            <!-- Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø§ÛŒÙ†Ø¬Ø§ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
        
        <div class="log-container">
            <div class="log-header">
                <h3>ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ø§Ø¬Ø±Ø§</h3>
                <button class="btn-secondary" onclick="clearLogs()" style="padding: 8px 16px;">
                    Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù„Ø§Ú¯â€ŒÙ‡Ø§
                </button>
            </div>
            <div id="logEntries"></div>
        </div>
    </div>
    
    <script>
        // ==================== ÙˆØ¶Ø¹ÛŒØª Ø¨Ø±Ù†Ø§Ù…Ù‡ ====================
        const appState = {
            config: null,
            modules: new Map(),
            logs: [],
            stats: {
                total: 0,
                loaded: 0,
                passed: 0,
                failed: 0
            }
        };
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ ====================
        function log(message, type = 'info', module = 'system') {
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const logId = `log_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            const logEntry = {
                id: logId,
                message,
                type,
                timestamp,
                module
            };
            
            appState.logs.unshift(logEntry);
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ØµÙØ­Ù‡
            const logElement = document.createElement('div');
            logElement.className = `log-entry ${type}`;
            logElement.innerHTML = `
                <strong>[${timestamp}]</strong> 
                <span style="color: #888; margin: 0 5px;">[${module}]</span>
                ${message}
            `;
            
            document.getElementById('logEntries').prepend(logElement);
            console.log(`[${type.toUpperCase()}] [${module}] ${message}`);
            
            updateStats();
            return logId;
        }
        
        function clearLogs() {
            document.getElementById('logEntries').innerHTML = '';
            appState.logs = [];
            log('Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'info');
        }
        
        // ==================== Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ ====================
        async function loadConfig() {
            try {
                log('Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ...', 'info');
                
                const response = await fetch('modules.config.json');
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÙØ§ÛŒÙ„: ${response.status}`);
                }
                
                appState.config = await response.json();
                log('Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯', 'success');
                
                // Ø³Ø§Ø®Øª Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ
                renderModulesUI();
                
            } catch (error) {
                log(`Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ: ${error.message}`, 'error');
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„ modules.config.json\nÙ…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ ÙØ§ÛŒÙ„ Ø¯Ø± Ø±ÛŒØ´Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯.');
            }
        }
        
        // ==================== Ø±Ù†Ø¯Ø± Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ ====================
        function renderModulesUI() {
            if (!appState.config) {
                log('Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª', 'warning');
                return;
            }
            
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            // Ù†Ø§Ù… ÙØ§Ø±Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§
            const categoryNames = {
                core: 'Ù‡Ø³ØªÙ‡ Ø§ØµÙ„ÛŒ',
                auth: 'Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª',
                components: 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§',
                pages: 'ØµÙØ­Ø§Øª',
                lessons: 'Ø³ÛŒØ³ØªÙ… Ø¯Ø±Ø³'
            };
            
            // Ø¢ÛŒÚ©ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¯Ø³ØªÙ‡
            const categoryIcons = {
                core: 'âš™ï¸',
                auth: 'ğŸ”',
                components: 'ğŸ¨',
                pages: 'ğŸ“„',
                lessons: 'ğŸ“š'
            };
            
            let totalModules = 0;
            
            // Ø³Ø§Ø®Øª Ù‡Ø± Ø¯Ø³ØªÙ‡
            for (const [category, files] of Object.entries(appState.config)) {
                if (!Array.isArray(files) || files.length === 0) continue;
                
                totalModules += files.length;
                
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                categorySection.innerHTML = `
                    <div class="category-header">
                        <div class="category-title">
                            <span>${categoryIcons[category] || 'ğŸ“¦'}</span>
                            <span>${categoryNames[category] || category}</span>
                        </div>
                        <span class="category-badge">${files.length} Ù…Ø§Ú˜ÙˆÙ„</span>
                    </div>
                    <div class="modules-grid" id="grid-${category}">
                        <!-- Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡ -->
                    </div>
                `;
                
                container.appendChild(categorySection);
                
                // Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ù‡Ø± ÙØ§ÛŒÙ„
                const grid = document.getElementById(`grid-${category}`);
                files.forEach(file => {
                    const moduleId = `${category}_${file.replace(/[\/\.]/g, '_')}`;
                    const fullPath = getFullPath(category, file);
                    
                    const moduleState = {
                        id: moduleId,
                        name: file,
                        category: category,
                        path: fullPath,
                        status: 'pending',
                        instance: null,
                        testResult: null
                    };
                    
                    appState.modules.set(moduleId, moduleState);
                    
                    const card = createModuleCard(moduleState);
                    grid.appendChild(card);
                });
            }
            
            appState.stats.total = totalModules;
            updateStats();
            log(`Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯: ${totalModules} Ù…Ø§Ú˜ÙˆÙ„ Ø¯Ø± ${Object.keys(appState.config).length} Ø¯Ø³ØªÙ‡`, 'success');
        }
        
        function getFullPath(category, filename) {
            const basePaths = {
                core: 'core/',
                auth: 'modules/auth/',
                components: 'components/',
                pages: 'pages/',
                lessons: 'modules/lessons/'
            };
            
            return `${basePaths[category] || ''}${filename}`;
        }
        
        function createModuleCard(moduleState) {
            const card = document.createElement('div');
            card.className = 'module-card';
            card.id = `card_${moduleState.id}`;
            
            card.innerHTML = `
                <div class="module-header">
                    <div class="module-name">${moduleState.name}</div>
                    <div class="module-status">
                        <div class="status-indicator status-pending" id="status_${moduleState.id}"></div>
                        <span class="status-text" id="statusText_${moduleState.id}">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</span>
                    </div>
                </div>
                
                <div class="module-path">${moduleState.path}</div>
                
                <div class="module-actions">
                    <button class="action-btn load" onclick="loadSingleModule('${moduleState.id}')" id="loadBtn_${moduleState.id}">
                        ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                    </button>
                    <button class="action-btn test" onclick="testSingleModule('${moduleState.id}')" id="testBtn_${moduleState.id}" disabled>
                        âš¡ ØªØ³Øª
                    </button>
                    <button class="action-btn clear" onclick="clearSingleModule('${moduleState.id}')" id="clearBtn_${moduleState.id}" disabled>
                        ğŸ—‘ï¸ Ù¾Ø§Ú©â€ŒÚ©Ù†
                    </button>
                </div>
            `;
            
            return card;
        }
        
        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ ====================
        async function loadSingleModule(moduleId) {
            const moduleState = appState.modules.get(moduleId);
            if (!moduleState) return;
            
            moduleState.status = 'testing';
            updateModuleUI(moduleId);
            
            try {
                log(`Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ${moduleState.name}...`, 'info', moduleState.name);
                
                const script = document.createElement('script');
                script.src = moduleState.path;
                script.type = 'module';
                
                await new Promise((resolve, reject) => {
                    script.onload = () => {
                        moduleState.status = 'loaded';
                        moduleState.instance = window[moduleState.name] || null;
                        
                        // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
                        document.getElementById(`testBtn_${moduleId}`).disabled = false;
                        document.getElementById(`clearBtn_${moduleId}`).disabled = false;
                        
                        log(`âœ… ${moduleState.name} Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`, 'success', moduleState.name);
                        appState.stats.loaded++;
                        updateStats();
                        resolve();
                    };
                    
                    script.onerror = () => {
                        moduleState.status = 'error';
                        log(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ${moduleState.name}`, 'error', moduleState.name);
                        reject(new Error(`Failed to load ${moduleState.name}`));
                    };
                    
                    document.head.appendChild(script);
                });
                
            } catch (error) {
                moduleState.status = 'error';
                log(`Ø®Ø·Ø§: ${error.message}`, 'error', moduleState.name);
            } finally {
                updateModuleUI(moduleId);
            }
        }
        
        async function testSingleModule(moduleId) {
            const moduleState = appState.modules.get(moduleId);
            if (!moduleState || moduleState.status !== 'loaded') {
                log(`Ø§Ø¨ØªØ¯Ø§ ${moduleState?.name} Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯`, 'warning', 'system');
                return;
            }
            
            moduleState.status = 'testing';
            updateModuleUI(moduleId);
            
            log(`ØªØ³Øª ${moduleState.name}...`, 'info', moduleState.name);
            
            try {
                const testResult = await runModuleTest(moduleState);
                
                if (testResult.success) {
                    moduleState.status = 'loaded';
                    moduleState.testResult = 'passed';
                    appState.stats.passed++;
                    log(`âœ… ${moduleState.name} ØªØ³Øª Ù…ÙˆÙÙ‚`, 'success', moduleState.name);
                } else {
                    moduleState.status = 'error';
                    moduleState.testResult = 'failed';
                    appState.stats.failed++;
                    log(`âŒ ${moduleState.name} ØªØ³Øª Ù†Ø§Ù…ÙˆÙÙ‚`, 'error', moduleState.name);
                }
                
            } catch (error) {
                moduleState.status = 'error';
                moduleState.testResult = 'failed';
                appState.stats.failed++;
                log(`Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª ${moduleState.name}: ${error.message}`, 'error', moduleState.name);
            } finally {
                updateModuleUI(moduleId);
                updateStats();
            }
        }
        
        async function runModuleTest(moduleState) {
            // ØªØ³Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù… ÙØ§ÛŒÙ„
            const name = moduleState.name.toLowerCase();
            
            if (name.includes('button')) {
                if (typeof VakamovaButton !== 'undefined') {
                    return { success: true, message: 'Button component detected' };
                }
            }
            
            if (name.includes('auth')) {
                if (typeof auth_manager !== 'undefined') {
                    return { success: true, message: 'Auth module detected' };
                }
            }
            
            if (name.includes('state')) {
                if (typeof HyperStateManager !== 'undefined') {
                    return { success: true, message: 'State manager detected' };
                }
            }
            
            if (name.includes('event')) {
                if (typeof eventBus !== 'undefined') {
                    return { success: true, message: 'Event bus detected' };
                }
            }
            
            // ØªØ³Øª Ø¹Ù…ÙˆÙ…ÛŒ
            if (moduleState.instance) {
                return { success: true, message: 'Module loaded successfully' };
            }
            
            return { success: false, error: 'No test available for this module type' };
        }
        
        function clearSingleModule(moduleId) {
            const moduleState = appState.modules.get(moduleId);
            if (!moduleState) return;
            
            // Ø­Ø°Ù Ø§Ø³Ú©Ø±ÛŒÙ¾Øª
            const scripts = document.querySelectorAll(`script[src="${moduleState.path}"]`);
            scripts.forEach(script => script.remove());
            
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª
            moduleState.status = 'pending';
            moduleState.instance = null;
            moduleState.testResult = null;
            
            // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.getElementById(`testBtn_${moduleId}`).disabled = true;
            document.getElementById(`clearBtn_${moduleId}`).disabled = true;
            
            // Ú©Ø§Ù‡Ø´ Ø¢Ù…Ø§Ø±
            if (moduleState.status === 'loaded') appState.stats.loaded--;
            if (moduleState.testResult === 'passed') appState.stats.passed--;
            if (moduleState.testResult === 'failed') appState.stats.failed--;
            
            updateModuleUI(moduleId);
            updateStats();
            log(`Ù…Ø§Ú˜ÙˆÙ„ ${moduleState.name} Ù¾Ø§Ú© Ø´Ø¯`, 'warning', moduleState.name);
        }
        
        function updateModuleUI(moduleId) {
            const moduleState = appState.modules.get(moduleId);
            if (!moduleState) return;
            
            const statusIndicator = document.getElementById(`status_${moduleId}`);
            const statusText = document.getElementById(`statusText_${moduleId}`);
            
            if (!statusIndicator || !statusText) return;
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù‚Ø¨Ù„ÛŒ
            statusIndicator.className = 'status-indicator';
            
            switch (moduleState.status) {
                case 'pending':
                    statusIndicator.classList.add('status-pending');
                    statusText.textContent = 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±';
                    break;
                case 'testing':
                    statusIndicator.classList.add('status-testing');
                    statusText.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
                    break;
                case 'loaded':
                    statusIndicator.classList.add('status-loaded');
                    statusText.textContent = moduleState.testResult === 'passed' ? 'ØªØ³Øª Ù…ÙˆÙÙ‚' : 'Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡';
                    break;
                case 'error':
                    statusIndicator.classList.add('status-error');
                    statusText.textContent = 'Ø®Ø·Ø§';
                    break;
            }
        }
        
        // ==================== Ø¹Ù…Ù„ÛŒØ§Øª Ú¯Ø±ÙˆÙ‡ÛŒ ====================
        async function loadAllModules() {
            if (!appState.config) {
                await loadConfig();
            }
            
            log('Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§...', 'info');
            
            for (const moduleId of appState.modules.keys()) {
                const moduleState = appState.modules.get(moduleId);
                if (moduleState.status === 'pending') {
                    await loadSingleModule(moduleId);
                    await new Promise(resolve => setTimeout(resolve, 200)); // ØªØ§Ø®ÛŒØ± Ø¨ÛŒÙ† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§
                }
            }
            
            log('Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯', 'success');
        }
        
        async function testAllModules() {
            log('Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§...', 'info');
            
            for (const moduleId of appState.modules.keys()) {
                const moduleState = appState.modules.get(moduleId);
                if (moduleState.status === 'loaded') {
                    await testSingleModule(moduleId);
                    await new Promise(resolve => setTimeout(resolve, 150)); // ØªØ§Ø®ÛŒØ± Ø¨ÛŒÙ† ØªØ³Øªâ€ŒÙ‡Ø§
                }
            }
            
            log('ØªØ³Øª Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯', 'success');
        }
        
        function clearAll() {
            for (const moduleId of appState.modules.keys()) {
                clearSingleModule(moduleId);
            }
            
            appState.stats.loaded = 0;
            appState.stats.passed = 0;
            appState.stats.failed = 0;
            
            updateStats();
            log('Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'warning');
        }
        
        // ==================== Ø¢Ù…Ø§Ø± Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ ====================
        function updateStats() {
            document.getElementById('totalModules').textContent = appState.stats.total;
            document.getElementById('loadedModules').textContent = appState.stats.loaded;
            document.getElementById('passedTests').textContent = appState.stats.passed;
            document.getElementById('failedTests').textContent = appState.stats.failed;
        }
        
        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
        window.addEventListener('DOMContentLoaded', () => {
            log('ØªØ³ØªØ± Ù¾ÙˆÛŒØ§ Vakamova Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯', 'success');
            log('Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ Ø¯Ú©Ù…Ù‡ "Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Config" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯', 'info');
        });
        
        // Ø§Ú©Ø³Ù¾ÙˆØ±Øª Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„
        window.VakamovaTester = {
            loadConfig,
            loadAllModules,
            testAllModules,
            clearAll,
            loadModule: loadSingleModule,
            testModule: testSingleModule,
            clearModule: clearSingleModule,
            getConfig: () => appState.config,
            getModules: () => Object.fromEntries(appState.modules),
            getStats: () => ({ ...appState.stats })
        };
    </script>
</body>
</html>
