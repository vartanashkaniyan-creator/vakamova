// loader.js - Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙ…Ø§Ù… Ø¯Ø±Ø³â€ŒÙ‡Ø§
async function loadAllLessons() {
  const container = document.getElementById('allLessonsContainer');
  if (!container) return;
  
  // Ø¬Ø³ØªØ¬ÙˆÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² Ø¯Ø±Ø³ Û± ØªØ§ ÛµÛ°
  for (let i = 1; i <= 50; i++) {
    try {
      const response = await fetch(`english_lesson_${i}.json`);
      if (!response.ok) continue; // Ø§Ú¯Ø± ÙØ§ÛŒÙ„ Ù†Ø¨ÙˆØ¯ØŒ Ø±Ø¯ Ø´Ùˆ
      
      const data = await response.json();
      
      // Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª Ø¯Ø±Ø³
      const lessonCard = document.createElement('div');
      lessonCard.className = 'lesson-card';
      lessonCard.style.cssText = `
        background: rgba(255,255,255,0.08);
        border: 1px solid rgba(76, 175, 80, 0.3);
        border-radius: 15px;
        padding: 20px;
        margin: 15px 0;
        animation: fadeIn 0.6s ease-out;
      `;
      
      lessonCard.innerHTML = `
        <h3 style="color: #4CAF50; margin-bottom: 10px;">
          ğŸ“š ${data.metadata.title}
        </h3>
        <p style="margin-bottom: 15px; opacity: 0.9;">
          ${data.metadata.subtitle}
        </p>
        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
          ${data.metadata.learning_objectives.map(obj => 
            `<span style="background: rgba(76,175,80,0.2); padding: 5px 10px; border-radius: 20px; font-size: 0.9rem;">
              ${obj}
            </span>`
          ).join('')}
        </div>
        <button onclick="showLessonDetail(${i})" style="
          background: linear-gradient(45deg, #2196F3, #1976D2);
          color: white;
          border: none;
          padding: 8px 20px;
          border-radius: 20px;
          cursor: pointer;
          margin-top: 10px;
        ">
          Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø±Ø³
        </button>
      `;
      
      container.appendChild(lessonCard);
    } catch (error) {
      // Ø§Ú¯Ø± ÙØ§ÛŒÙ„ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´Øª ÛŒØ§ Ø®Ø·Ø§ Ø¯Ø§Ø´ØªØŒ Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø¯Ù‡
    }
  }
}

// ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø±Ø³
function showLessonDetail(lessonNumber) {
  fetch(`english_lesson_${lessonNumber}.json`)
    .then(response => response.json())
    .then(data => {
      alert(`Ø¯Ø±Ø³ ${lessonNumber}: ${data.metadata.title}\n\nØ§Ù‡Ø¯Ø§Ù ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ:\nâ€¢ ${data.metadata.learning_objectives.join('\nâ€¢ ')}`);
    })
    .catch(() => alert('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø³'));
}

// Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ù„ÙˆØ¯ ØµÙØ­Ù‡
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', loadAllLessons);
} else {
  loadAllLessons();
}
