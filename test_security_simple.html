<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ Ø³Ø§Ø¯Ù‡</title>
    <style>
        body { font-family: Tahoma; padding: 20px; }
        .passed { color: green; background: #e8f5e9; padding: 10px; margin: 5px 0; }
        .failed { color: #d32f2f; background: #ffebee; padding: 10px; margin: 5px 0; }
        button { background: #2196f3; color: white; border: none; padding: 10px 20px; cursor: pointer; }
    </style>
</head>
<body>
    <h2>ğŸ” ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ Ù¾Ø§ÛŒÙ‡</h2>
    <button onclick="runSecurityTests()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª Ø§Ù…Ù†ÛŒØª</button>
    <div id="results"></div>

    <script>
        async function runSecurityTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h3>Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØª...</h3>';
            
            const tests = [];
            
            // ğŸ”¹ ØªØ³Øª 1: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªÙˆÚ©Ù†
            function validateToken(token) {
                if (!token || token.length < 10) return false;
                if (token.includes(' ') || token.includes('\n')) return false;
                return true;
            }
            
            const tokenTest = validateToken('valid_token_123');
            tests.push({ name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªÙˆÚ©Ù†', passed: tokenTest });
            
            // ğŸ”¹ ØªØ³Øª 2: Ø³Ø§Ù†ÛŒâ€ŒØªØ§ÛŒØ² ÙˆØ±ÙˆØ¯ÛŒ
            function sanitizeInput(input) {
                return input.replace(/[<>'"]/g, '').trim();
            }
            
            const dirtyInput = '<script>alert("xss")</script>';
            const cleanInput = sanitizeInput(dirtyInput);
            const sanitizeTest = !cleanInput.includes('<script>');
            tests.push({ name: 'Ø³Ø§Ù†ÛŒØªØ§ÛŒØ² ÙˆØ±ÙˆØ¯ÛŒ XSS', passed: sanitizeTest });
            
            // ğŸ”¹ ØªØ³Øª 3: Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡ Ø­Ø³Ø§Ø³
            function encryptData(data) {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø³Ø§Ø¯Ù‡
                return btoa(encodeURIComponent(data));
            }
            
            const sensitiveData = 'credit_card_123';
            const encrypted = encryptData(sensitiveData);
            const encryptionTest = encrypted !== sensitiveData;
            tests.push({ name: 'Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡ Ø­Ø³Ø§Ø³', passed: encryptionTest });
            
            // ğŸ”¹ ØªØ³Øª 4: Ø¨Ø±Ø±Ø³ÛŒ localStorage Ø§Ù…Ù†
            function testLocalStorageSecurity() {
                try {
                    // ØªØ³Øª Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ø§Ø¯Ù‡ Ø­Ø³Ø§Ø³ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´ÙˆØ¯
                    const testData = { token: 'test', shouldBeEncrypted: true };
                    localStorage.setItem('test_sec', JSON.stringify(testData));
                    const retrieved = JSON.parse(localStorage.getItem('test_sec'));
                    localStorage.removeItem('test_sec');
                    
                    // Ø§Ú¯Ø± token Ø¨Ù‡ ØµÙˆØ±Øª plain Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ØŒ Ù†Ø§Ù…ÙˆÙÙ‚ Ø§Ø³Øª
                    return retrieved.token !== 'test';
                } catch {
                    return true;
                }
            }
            
            const storageTest = testLocalStorageSecurity();
            tests.push({ name: 'Ø§Ù…Ù†ÛŒØª localStorage', passed: storageTest });
            
            // ğŸ”¹ ØªØ³Øª 5: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§ÛŒÙ…ÛŒÙ„
            function validateEmail(email) {
                const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return regex.test(email);
            }
            
            const emailTest = validateEmail('test@vakamova.com') && !validateEmail('invalid-email');
            tests.push({ name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§ÛŒÙ…ÛŒÙ„', passed: emailTest });
            
            // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
            const passedCount = tests.filter(t => t.passed).length;
            const totalCount = tests.length;
            
            resultsDiv.innerHTML = `
                <h3>Ù†ØªØ§ÛŒØ¬ ØªØ³Øª Ø§Ù…Ù†ÛŒØª:</h3>
                <p>${passedCount} Ø§Ø² ${totalCount} ØªØ³Øª Ù…ÙˆÙÙ‚</p>
                ${tests.map(t => `
                    <div class="${t.passed ? 'passed' : 'failed'}">
                        ${t.passed ? 'âœ…' : 'âŒ'} ${t.name}
                    </div>
                `).join('')}
                <p><strong>${passedCount === totalCount ? 'âœ… Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ Ù…ÙˆÙÙ‚' : 'âš ï¸ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ø¨ÛŒØ´ØªØ±'}</strong></p>
            `;
        }
    </script>
</body>
</html>
