<!DOCTYPE html>
<html>
<head><title>ØªØ³Øª Ø³Ø±ÛŒØ¹ LessonEngine</title><meta charset="utf-8"></head>
<body style="font-family:Tahoma; padding:20px;">
    <h2>ğŸ§ª ØªØ³Øª LessonEngine</h2>
    <button onclick="runQuickTest()">Ø§Ø¬Ø±Ø§</button>
    <div id="results" style="margin-top:20px;"></div>

    <script>
        // Ú©Ø¯ Ø§ØµÙ„ÛŒ (Ø®Ù„Ø§ØµÙ‡â€ŒØ´Ø¯Ù‡)
        class LessonEngine {
            constructor({database, eventBus, progressTracker}) {
                this._database = database;
                this._eventBus = eventBus;
                this._progressTracker = progressTracker;
                this._activeSessions = new Map();
            }
            async loadCourse(courseId) {
                return {id: courseId, title: "Ø¯ÙˆØ±Ù‡ ØªØ³Øª", totalLessons: 5};
            }
            async startLesson(lessonId, userId) {
                const session = {id: 'sess_1', lessonId, userId, status: 'active'};
                this._activeSessions.set(session.id, session);
                return session;
            }
            async submitExercise(submission) {
                return {isCorrect: true, score: 10, feedback: "Ø®ÙˆØ¨"};
            }
            async getProgress(userId, courseId) {
                return {userId, courseId, completionPercentage: 30};
            }
        }

        async function runQuickTest() {
            const results = document.getElementById('results');
            results.innerHTML = '';
            
            // Mock dependencies
            const deps = {
                database: {query: () => ({where: () => ({andWhere: () => ({with: () => ({first: () => ({})})})})})},
                eventBus: {publish: () => {}},
                progressTracker: {startSession: async () => {}, recordExerciseResult: async () => {}, getUserProgress: async () => ({})}
            };
            
            try {
                const engine = new LessonEngine(deps);
                addResult('âœ… Ù…ÙˆØªÙˆØ± Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯');
                
                const course = await engine.loadCourse('test_course');
                addResult(`âœ… Ø¯ÙˆØ±Ù‡ "${course.title}" Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`);
                
                const session = await engine.startLesson('lesson_1', 'user_123');
                addResult(`âœ… Ø¬Ù„Ø³Ù‡ ${session.id} Ø´Ø±ÙˆØ¹ Ø´Ø¯`);
                
                const progress = await engine.getProgress('user_123', 'test_course');
                addResult(`âœ… Ù¾ÛŒØ´Ø±ÙØª: ${progress.completionPercentage}%`);
                
                addResult('<br><strong>ğŸ‰ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ Ù…ÙˆÙÙ‚!</strong>');
            } catch(error) {
                addResult(`âŒ Ø®Ø·Ø§: ${error}`);
            }
        }
        
        function addResult(text) {
            const div = document.createElement('div');
            div.innerHTML = text;
            div.style.padding = '8px';
            div.style.borderBottom = '1px solid #eee';
            document.getElementById('results').appendChild(div);
        }
    </script>
</body>
</html>
