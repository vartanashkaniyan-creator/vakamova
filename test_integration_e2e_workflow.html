<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª End-to-End Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± - Vakamova</title>
    <style>
        :root {
            --primary: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f8fafc;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', 'Vazirmatn', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        .badge {
            background: var(--success);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        .test-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            padding: 25px;
            background: var(--light);
            border-bottom: 2px solid #e2e8f0;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        
        .stat:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #6b7280;
            text-align: center;
        }
        
        .workflow-container {
            display: flex;
            min-height: 700px;
        }
        
        .timeline {
            width: 300px;
            background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 30px 20px;
            border-right: 2px solid #e2e8f0;
            overflow-y: auto;
        }
        
        .timeline-step {
            display: flex;
            align-items: center;
            padding: 20px;
            margin-bottom: 15px;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }
        
        .timeline-step:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(79, 70, 229, 0.1);
        }
        
        .timeline-step.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }
        
        .timeline-step.completed {
            border-color: var(--success);
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 15px;
            flex-shrink: 0;
        }
        
        .timeline-step.active .step-number {
            background: var(--primary);
            color: white;
        }
        
        .timeline-step.completed .step-number {
            background: var(--success);
            color: white;
        }
        
        .step-info {
            flex: 1;
        }
        
        .step-title {
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .step-desc {
            font-size: 0.85rem;
            color: #6b7280;
        }
        
        .content-area {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
        }
        
        .test-scenario {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            border: 2px solid #e2e8f0;
        }
        
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .scenario-title {
            font-size: 1.5rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .scenario-status {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-running {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .scenario-content {
            margin-bottom: 20px;
        }
        
        .scenario-details {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            color: #6b7280;
            font-weight: 500;
        }
        
        .detail-value {
            color: var(--dark);
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            background: linear-gradient(135deg, var(--primary) 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 150px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #start-btn {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
        }
        
        #reset-btn {
            background: linear-gradient(135deg, #6b7280 0%, #9ca3af 100%);
        }
        
        .console {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 25px;
            flex: 1;
            overflow-y: auto;
            max-height: 300px;
        }
        
        .console-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #374151;
        }
        
        .console-title {
            font-weight: bold;
            color: #94a3b8;
        }
        
        .console-controls button {
            padding: 6px 12px;
            font-size: 0.8rem;
            min-width: auto;
            background: #374151;
        }
        
        .console-content {
            line-height: 1.5;
        }
        
        .log-entry {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .log-time {
            color: #94a3b8;
            margin-left: 10px;
        }
        
        .log-info {
            color: #60a5fa;
        }
        
        .log-success {
            color: #34d399;
        }
        
        .log-warning {
            color: #fbbf24;
        }
        
        .log-error {
            color: #f87171;
        }
        
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-bar {
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, #7c3aed 100%);
            border-radius: 6px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #e2e8f0;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @media (max-width: 1024px) {
            .workflow-container {
                flex-direction: column;
            }
            
            .timeline {
                width: 100%;
                border-right: none;
                border-bottom: 2px solid #e2e8f0;
            }
        }
        
        @media (max-width: 768px) {
            .test-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            header h1 {
                flex-direction: column;
                gap: 10px;
            }
            
            .controls {
                flex-wrap: wrap;
            }
            
            button {
                flex: 1;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <span>ğŸ§ª ØªØ³Øª End-to-End Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø±</span>
                <span class="badge">Vakamova</span>
            </h1>
            <p>Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… ØªØ§ ØªÚ©Ù…ÛŒÙ„ Ø¯Ø±Ø³</p>
        </header>
        
        <div class="test-stats">
            <div class="stat">
                <span class="stat-value" id="total-steps">8</span>
                <span class="stat-label">Ù…Ø±Ø­Ù„Ù‡ Ø¯Ø± Ú¯Ø±Ø¯Ø´</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="completed-steps">0</span>
                <span class="stat-label">Ù…Ø±Ø§Ø­Ù„ ØªÚ©Ù…ÛŒÙ„â€ŒØ´Ø¯Ù‡</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="success-rate">0%</span>
                <span class="stat-label">Ù†Ø±Ø® Ù…ÙˆÙÙ‚ÛŒØª</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="execution-time">0s</span>
                <span class="stat-label">Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§</span>
            </div>
        </div>
        
        <div class="workflow-container">
            <div class="timeline" id="timeline">
                <!-- Timeline steps will be populated by JavaScript -->
            </div>
            
            <div class="content-area">
                <div class="test-scenario">
                    <div class="scenario-header">
                        <div class="scenario-title">
                            <span>ğŸ“‹ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Vakamova</span>
                        </div>
                        <div class="scenario-status status-pending" id="scenario-status">
                            Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø´Ø±ÙˆØ¹
                        </div>
                    </div>
                    
                    <div class="scenario-content">
                        <p>Ø§ÛŒÙ† ØªØ³Øª ØªÙ…Ø§Ù…ÛŒ Ù…Ø±Ø§Ø­Ù„ Ú¯Ø±Ø¯Ø´ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Vakamova Ø±Ø§ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:</p>
                        <ol style="margin: 15px 0; padding-right: 20px;">
                            <li>Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ø³ÛŒØ³ØªÙ…</li>
                            <li>ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</li>
                            <li>Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø±ÙˆØ³ Ù…ÙˆØ¬ÙˆØ¯</li>
                            <li>Ø®Ø±ÛŒØ¯ ÛŒÚ© Ø¯Ø±Ø³ Ø¨Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª</li>
                            <li>Ø´Ø±ÙˆØ¹ Ø¯Ø±Ø³ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡</li>
                            <li>ØªÚ©Ù…ÛŒÙ„ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³</li>
                            <li>Ø¯Ø±ÛŒØ§ÙØª Ø§Ù…ØªÛŒØ§Ø² Ùˆ Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø·Ø­</li>
                            <li>Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø´Ø¯Ù‡</li>
                        </ol>
                    </div>
                    
                    <div class="scenario-details" id="scenario-details">
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª:</span>
                            <span class="detail-value" id="test-user">Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø¯Ø±Ø³ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ:</span>
                            <span class="detail-value" id="test-lesson">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªØ®Ø§Ø¨...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®Øª:</span>
                            <span class="detail-value" id="test-amount">0 Ø±ÛŒØ§Ù„</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§Ù…ØªÛŒØ§Ø² Ù¾Ø§ÛŒÙ‡:</span>
                            <span class="detail-value" id="test-score">0</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø±:</span>
                            <span class="detail-value" id="test-level">Ù…Ø¨ØªØ¯ÛŒ</span>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text">
                            <span>Ù¾ÛŒØ´Ø±ÙØª ØªØ³Øª</span>
                            <span id="progress-text">0%</span>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button id="start-btn" onclick="startWorkflow()">
                            <span>â–¶ï¸</span>
                            Ø´Ø±ÙˆØ¹ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„
                        </button>
                        <button id="step-btn" onclick="runNextStep()" disabled>
                            <span>â­ï¸</span>
                            Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ÛŒ
                        </button>
                        <button id="reset-btn" onclick="resetWorkflow()">
                            <span>ğŸ”„</span>
                            Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯
                        </button>
                    </div>
                </div>
                
                <div class="console">
                    <div class="console-header">
                        <div class="console-title">Ú©Ù†Ø³ÙˆÙ„ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</div>
                        <div class="console-controls">
                            <button onclick="clearConsole()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ù†Ø³ÙˆÙ„</button>
                        </div>
                    </div>
                    <div class="console-content" id="console-output">
                        <div class="log-entry log-info">ğŸš€ Ø³ÛŒØ³ØªÙ… ØªØ³Øª End-to-End Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§ Ø§Ø³Øª</div>
                        <div class="log-entry log-info">ğŸ“± Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Û¸ Ù…Ø±Ø­Ù„Ù‡ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯</div>
                        <div class="log-entry log-info">ğŸ’¾ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Auth, Database, Payment, State, Lesson Ø¨Ø§ Ù‡Ù… ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ ==========
        const logger = {
            log: (message, type = 'info', data = null) => {
                const time = new Date().toLocaleTimeString('fa-IR', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const consoleEl = document.getElementById('console-output');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                
                let logMessage = `<span class="log-time">[${time}]</span> ${message}`;
                
                if (data) {
                    logMessage += ` <small style="color: #94a3b8">(${JSON.stringify(data)})</small>`;
                }
                
                logEntry.innerHTML = logMessage;
                consoleEl.appendChild(logEntry);
                consoleEl.scrollTop = consoleEl.scrollHeight;
                
                // Log to browser console as well
                const consoleMethod = type === 'error' ? 'error' : 
                                     type === 'warning' ? 'warn' : 
                                     type === 'success' ? 'log' : 'info';
                console[consoleMethod](`[${time}] ${message}`, data || '');
            },
            
            info: (message, data) => logger.log(message, 'info', data),
            success: (message, data) => logger.log(message, 'success', data),
            warning: (message, data) => logger.log(message, 'warning', data),
            error: (message, data) => logger.log(message, 'error', data)
        };

        // ========== ØªØ¹Ø±ÛŒÙ Ù…Ø±Ø§Ø­Ù„ Ú¯Ø±Ø¯Ø´ ==========
        const workflowSteps = [
            {
                id: 1,
                title: 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±',
                description: 'Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„',
                icon: 'ğŸ‘¤',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û±: Ø´Ø±ÙˆØ¹ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±...');
                    
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø®ÛŒØ± Ø´Ø¨Ú©Ù‡
                    await delay(500);
                    
                    // Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª
                    const testUser = {
                        id: `user_${Date.now()}`,
                        email: `test${Math.floor(Math.random() * 10000)}@vakamova.com`,
                        name: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª Vakamova',
                        password: 'securePassword123',
                        createdAt: new Date().toISOString()
                    };
                    
                    window.testData = { user: testUser };
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                    document.getElementById('test-user').textContent = testUser.email;
                    document.getElementById('test-user').style.color = '#10b981';
                    
                    logger.success('Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', {
                        userId: testUser.id,
                        email: testUser.email
                    });
                    
                    return testUser;
                }
            },
            {
                id: 2,
                title: 'ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…',
                description: 'Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ú©Ø§Ø±Ø¨Ø± Ùˆ Ø§ÛŒØ¬Ø§Ø¯ Ø³Ø´Ù†',
                icon: 'ğŸ”',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û²: Ø´Ø±ÙˆØ¹ ÙØ±Ø¢ÛŒÙ†Ø¯ ÙˆØ±ÙˆØ¯...');
                    
                    await delay(400);
                    
                    if (!window.testData?.user) {
                        throw new Error('Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    }
                    
                    const session = {
                        id: `session_${Date.now()}`,
                        userId: window.testData.user.id,
                        token: `token_${Math.random().toString(36).substr(2, 20)}`,
                        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                        createdAt: new Date().toISOString()
                    };
                    
                    window.testData.session = session;
                    
                    logger.success('ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', {
                        sessionId: session.id,
                        expiresAt: session.expiresAt
                    });
                    
                    return session;
                }
            },
            {
                id: 3,
                title: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø±ÙˆØ³',
                description: 'Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø¯Ø±ÙˆØ³ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±',
                icon: 'ğŸ“š',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û³: Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø¯Ø±ÙˆØ³...');
                    
                    await delay(600);
                    
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø±ÙˆØ³ Ù…ÙˆØ¬ÙˆØ¯
                    const lessons = [
                        { id: 'lesson_1', title: 'Ù…Ù‚Ø¯Ù…Ø§Øª Ø²Ø¨Ø§Ù† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ', price: 49000, level: 'Ù…Ø¨ØªØ¯ÛŒ' },
                        { id: 'lesson_2', title: 'Ú¯Ø±Ø§Ù…Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡', price: 79000, level: 'Ù…ØªÙˆØ³Ø·' },
                        { id: 'lesson_3', title: 'Ù…Ú©Ø§Ù„Ù…Ù‡ ØªØ¬Ø§Ø±ÛŒ', price: 99000, level: 'Ù¾ÛŒØ´Ø±ÙØªÙ‡' },
                        { id: 'lesson_4', title: 'Ø¢Ù…Ø§Ø¯Ú¯ÛŒ Ø¢Ø²Ù…ÙˆÙ† IELTS', price: 149000, level: 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ' }
                    ];
                    
                    // Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§Ø¯ÙÛŒ ÛŒÚ© Ø¯Ø±Ø³
                    const selectedLesson = lessons[Math.floor(Math.random() * lessons.length)];
                    window.testData.selectedLesson = selectedLesson;
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                    document.getElementById('test-lesson').textContent = selectedLesson.title;
                    document.getElementById('test-amount').textContent = 
                        selectedLesson.price.toLocaleString('fa-IR') + ' Ø±ÛŒØ§Ù„';
                    
                    logger.success('Ù„ÛŒØ³Øª Ø¯Ø±ÙˆØ³ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯', {
                        totalLessons: lessons.length,
                        selectedLesson: selectedLesson.title,
                        price: selectedLesson.price
                    });
                    
                    return lessons;
                }
            },
            {
                id: 4,
                title: 'Ø®Ø±ÛŒØ¯ Ø¯Ø±Ø³',
                description: 'Ø§Ù†Ø¬Ø§Ù… Ù¾Ø±Ø¯Ø§Ø®Øª Ùˆ Ø®Ø±ÛŒØ¯ Ø¯Ø±Ø³ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡',
                icon: 'ğŸ’³',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û´: Ø´Ø±ÙˆØ¹ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø®Ø±ÛŒØ¯...');
                    
                    if (!window.testData?.selectedLesson) {
                        throw new Error('Ø¯Ø±Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª');
                    }
                    
                    await delay(800);
                    
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª
                    const payment = {
                        id: `payment_${Date.now()}`,
                        userId: window.testData.user.id,
                        lessonId: window.testData.selectedLesson.id,
                        amount: window.testData.selectedLesson.price,
                        currency: 'IRR',
                        status: 'completed',
                        transactionId: `txn_${Math.random().toString(36).substr(2, 15)}`,
                        paidAt: new Date().toISOString()
                    };
                    
                    window.testData.payment = payment;
                    
                    logger.success('Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', {
                        paymentId: payment.id,
                        amount: payment.amount,
                        transactionId: payment.transactionId
                    });
                    
                    return payment;
                }
            },
            {
                id: 5,
                title: 'Ø´Ø±ÙˆØ¹ Ø¯Ø±Ø³',
                description: 'Ø´Ø±ÙˆØ¹ Ø¯Ø±Ø³ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡ Ùˆ Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù¾ÛŒØ´Ø±ÙØª',
                icon: 'ğŸ¬',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Ûµ: Ø´Ø±ÙˆØ¹ Ø¯Ø±Ø³ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡...');
                    
                    await delay(300);
                    
                    if (!window.testData?.selectedLesson) {
                        throw new Error('Ø¯Ø±Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    }
                    
                    const lessonProgress = {
                        id: `progress_${Date.now()}`,
                        userId: window.testData.user.id,
                        lessonId: window.testData.selectedLesson.id,
                        status: 'started',
                        startedAt: new Date().toISOString(),
                        currentUnit: 1,
                        totalUnits: 10,
                        score: 0
                    };
                    
                    window.testData.lessonProgress = lessonProgress;
                    
                    logger.success('Ø¯Ø±Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ø±ÙˆØ¹ Ø´Ø¯', {
                        lessonId: lessonProgress.lessonId,
                        currentUnit: lessonProgress.currentUnit,
                        totalUnits: lessonProgress.totalUnits
                    });
                    
                    return lessonProgress;
                }
            },
            {
                id: 6,
                title: 'ØªÚ©Ù…ÛŒÙ„ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§',
                description: 'Ø§Ù†Ø¬Ø§Ù… ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ø§Ù…ØªÛŒØ§Ø²',
                icon: 'âœ…',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û¶: Ø§Ù†Ø¬Ø§Ù… ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³...');
                    
                    if (!window.testData?.lessonProgress) {
                        throw new Error('Ù¾ÛŒØ´Ø±ÙØªÛŒ Ø¨Ø±Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    }
                    
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªÚ©Ù…ÛŒÙ„ Û±Û° ÙˆØ§Ø­Ø¯
                    let totalScore = 0;
                    for (let i = 1; i <= 10; i++) {
                        await delay(150);
                        const unitScore = Math.floor(Math.random() * 10) + 5; // 5-14
                        totalScore += unitScore;
                        
                        window.testData.lessonProgress.currentUnit = i;
                        window.testData.lessonProgress.score = totalScore;
                        
                        logger.info(`ÙˆØ§Ø­Ø¯ ${i} ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯`, { score: unitScore, totalScore });
                    }
                    
                    window.testData.lessonProgress.status = 'completed';
                    window.testData.lessonProgress.completedAt = new Date().toISOString();
                    window.testData.lessonProgress.finalScore = totalScore;
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                    document.getElementById('test-score').textContent = totalScore;
                    document.getElementById('test-score').style.color = '#10b981';
                    
                    logger.success('ØªÙ…Ø§Ù…ÛŒ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù†Ø¯', {
                        totalScore: totalScore,
                        unitsCompleted: 10
                    });
                    
                    return window.testData.lessonProgress;
                }
            },
            {
                id: 7,
                title: 'Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø·Ø­',
                description: 'Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·Ø­ Ø¬Ø¯ÛŒØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø²',
                icon: 'ğŸ“ˆ',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û·: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø±...');
                    
                    await delay(400);
                    
                    if (!window.testData?.lessonProgress?.finalScore) {
                        throw new Error('Ø§Ù…ØªÛŒØ§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·Ø­ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    }
                    
                    const score = window.testData.lessonProgress.finalScore;
                    
                    // ØªØ¹ÛŒÛŒÙ† Ø³Ø·Ø­ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø²
                    let level, xp;
                    if (score >= 100) {
                        level = 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ';
                        xp = 500;
                    } else if (score >= 70) {
                        level = 'Ù…ØªÙˆØ³Ø·';
                        xp = 300;
                    } else if (score >= 40) {
                        level = 'Ù…Ø¨ØªØ¯ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡';
                        xp = 150;
                    } else {
                        level = 'Ù…Ø¨ØªØ¯ÛŒ';
                        xp = 50;
                    }
                    
                    window.testData.user.level = level;
                    window.testData.user.xp = (window.testData.user.xp || 0) + xp;
                    window.testData.user.totalLessonsCompleted = 
                        (window.testData.user.totalLessonsCompleted || 0) + 1;
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                    document.getElementById('test-level').textContent = level;
                    document.getElementById('test-level').style.color = '#8b5cf6';
                    
                    logger.success('Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø± Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØª', {
                        newLevel: level,
                        xpEarned: xp,
                        totalXP: window.testData.user.xp
                    });
                    
                    return { level, xp, totalXP: window.testData.user.xp };
                }
            },
            {
                id: 8,
                title: 'Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ',
                description: 'Ù†Ù…Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø´Ø¯Ù‡ Ú©Ø§Ø±Ø¨Ø±',
                icon: 'ğŸ†',
                status: 'pending',
                action: async () => {
                    logger.info('Ù…Ø±Ø­Ù„Ù‡ Û¸: Ù†Ù…Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ...');
                    
                    await delay(300);
                    
                    if (!window.testData?.user) {
                        throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                    }
                    
                    const finalProfile = {
                        userId: window.testData.user.id,
                        email: window.testData.user.email,
                        level: window.testData.user.level,
                        totalXP: window.testData.user.xp,
                        lessonsCompleted: window.testData.user.totalLessonsCompleted,
                        totalSpent: window.testData.payment?.amount || 0,
                        joinedAt: window.testData.user.createdAt,
                        lastActivity: new Date().toISOString()
                    };
                    
                    window.testData.finalProfile = finalProfile;
                    
                    logger.success('Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª', finalProfile);
                    
                    return finalProfile;
                }
            }
        ];

        // ========== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø­Ø§Ù„Øª ==========
        let currentStep = 0;
        let isRunning = false;
        let startTime = null;
        let completedSteps = 0;
        let successfulSteps = 0;

        // ========== ØªØ§Ø¨Ø¹ ØªØ§Ø®ÛŒØ± ==========
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ========== Ø±Ù†Ø¯Ø± Timeline ==========
        function renderTimeline() {
            const timelineEl = document.getElementById('timeline');
            timelineEl.innerHTML = '';
            
            workflowSteps.forEach(step => {
                const stepEl = document.createElement('div');
                stepEl.className = `timeline-step ${step.status}`;
                if (step.id === currentStep + 1) {
                    stepEl.classList.add('active');
                }
                
                stepEl.innerHTML = `
                    <div class="step-number">${step.icon}</div>
                    <div class="step-info">
                        <div class="step-title">${step.title}</div>
                        <div class="step-desc">${step.description}</div>
                    </div>
                    <div style="margin-right: auto; font-size: 0.8rem; color: #6b7280;">
                        ${step.status === 'completed' ? 'âœ…' : 
                          step.status === 'running' ? 'â³' : 
                          step.status === 'failed' ? 'âŒ' : 'â¸ï¸'}
                    </div>
                `;
                
                timelineEl.appendChild(stepEl);
            });
        }

        // ========== Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø± ==========
        function updateStats() {
            document.getElementById('completed-steps').textContent = completedSteps;
            document.getElementById('total-steps').textContent = workflowSteps.length;
            
            const successRate = workflowSteps.length > 0 
                ? Math.round((successfulSteps / workflowSteps.length) * 100) 
                : 0;
            document.getElementById('success-rate').textContent = `${successRate}%`;
            
            if (startTime) {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                document.getElementById('execution-time').textContent = `${elapsed}s`;
            }
            
            const progressPercent = Math.round((completedSteps / workflowSteps.length) * 100);
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            document.getElementById('progress-text').textContent = `${progressPercent}%`;
        }

        // ========== Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡ ==========
        async function runStep(stepIndex) {
            const step = workflowSteps[stepIndex];
            
            if (!step || isRunning) return false;
            
            isRunning = true;
            step.status = 'running';
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
            document.getElementById('scenario-status').className = 'scenario-status status-running';
            document.getElementById('scenario-status').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§...';
            document.getElementById('step-btn').disabled = true;
            
            renderTimeline();
            
            try {
                logger.info(`Ø´Ø±ÙˆØ¹ Ù…Ø±Ø­Ù„Ù‡ ${step.id}: ${step.title}`);
                
                const result = await step.action();
                
                // Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ØªÚ©Ù…ÛŒÙ„â€ŒØ´Ø¯Ù‡
                step.status = 'completed';
                completedSteps++;
                successfulSteps++;
                
                logger.success(`Ù…Ø±Ø­Ù„Ù‡ ${step.id} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯`);
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±
                updateStats();
                
                // Ø§Ú¯Ø± Ø¢Ø®Ø±ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨ÙˆØ¯
                if (stepIndex === workflowSteps.length - 1) {
                    completeWorkflow();
                }
                
                return result;
                
            } catch (error) {
                step.status = 'failed';
                completedSteps++;
                
                logger.error(`Ø®Ø·Ø§ Ø¯Ø± Ù…Ø±Ø­Ù„Ù‡ ${step.id}: ${error.message}`);
                document.getElementById('scenario-status').className = 'scenario-status status-failed';
                document.getElementById('scenario-status').textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§';
                
                updateStats();
                return null;
                
            } finally {
                isRunning = false;
                document.getElementById('step-btn').disabled = false;
                renderTimeline();
            }
        }

        // ========== Ø´Ø±ÙˆØ¹ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ ==========
        async function startWorkflow() {
            if (isRunning) return;
            
            logger.info('ğŸš€ Ø´Ø±ÙˆØ¹ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ End-to-End...');
            logger.info('='.repeat(50));
            
            startTime = Date.now();
            currentStep = 0;
            completedSteps = 0;
            successfulSteps = 0;
            
            // Ø±ÛŒØ³Øªâ€ŒÚ©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª Ù…Ø±Ø§Ø­Ù„
            workflowSteps.forEach(step => step.status = 'pending');
            
            // Ø±ÛŒØ³Øªâ€ŒÚ©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ³Øª
            window.testData = {};
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
            document.getElementById('start-btn').disabled = true;
            document.getElementById('step-btn').disabled = false;
            document.getElementById('scenario-status').className = 'scenario-status status-running';
            document.getElementById('scenario-status').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§...';
            
            // Ø±ÛŒØ³Øªâ€ŒÚ©Ø±Ø¯Ù† Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
            document.getElementById('test-user').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ...';
            document.getElementById('test-lesson').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªØ®Ø§Ø¨...';
            document.getElementById('test-amount').textContent = '0 Ø±ÛŒØ§Ù„';
            document.getElementById('test-score').textContent = '0';
            document.getElementById('test-level').textContent = 'Ù…Ø¨ØªØ¯ÛŒ';
            
            renderTimeline();
            updateStats();
            
            // Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„
            for (let i = 0; i < workflowSteps.length; i++) {
                currentStep = i;
                const result = await runStep(i);
                
                if (!result && i === 0) {
                    // Ø§Ú¯Ø± Ø§ÙˆÙ„ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯ØŒ Ù…ØªÙˆÙ‚Ù Ø´Ùˆ
                    break;
                }
                
                // ØªØ§Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ø¨ÛŒÙ† Ù…Ø±Ø§Ø­Ù„
                if (i < workflowSteps.length - 1) {
                    await delay(500);
                }
            }
        }

        // ========== Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ÛŒ ==========
        async function runNextStep() {
            if (isRunning || currentStep >= workflowSteps.length) return;
            
            await runStep(currentStep);
            currentStep++;
        }

        // ========== ØªÚ©Ù…ÛŒÙ„ Ú¯Ø±Ø¯Ø´ ==========
        function completeWorkflow() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            
            logger.success('='.repeat(50));
            logger.success(`ğŸ‰ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„ End-to-End Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!`);
            logger.success(`â±ï¸ Ø²Ù…Ø§Ù† Ú©Ù„ Ø§Ø¬Ø±Ø§: ${elapsed} Ø«Ø§Ù†ÛŒÙ‡`);
            logger.success(`âœ… Ù…Ø±Ø§Ø­Ù„ Ù…ÙˆÙÙ‚: ${successfulSteps} Ø§Ø² ${workflowSteps.length}`);
            logger.success('='.repeat(50));
            
            document.getElementById('scenario-status').className = 'scenario-status status-success';
            document.getElementById('scenario-status').textContent = 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯';
            document.getElementById('start-btn').disabled = false;
            document.getElementById('step-btn').disabled = true;
            
            // Ù†Ù…Ø§ÛŒØ´ Ø®Ù„Ø§ØµÙ‡
            if (window.testData?.finalProfile) {
                logger.info('ğŸ“Š Ø®Ù„Ø§ØµÙ‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ Ú©Ø§Ø±Ø¨Ø±:', window.testData.finalProfile);
            }
        }

        // ========== Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ ==========
        function resetWorkflow() {
            logger.info('ğŸ”„ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù…Ø¬Ø¯Ø¯ ØªØ³Øª...');
            
            currentStep = 0;
            completedSteps = 0;
            successfulSteps = 0;
            isRunning = false;
            startTime = null;
            
            // Ø±ÛŒØ³Øªâ€ŒÚ©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª Ù…Ø±Ø§Ø­Ù„
            workflowSteps.forEach(step => step.status = 'pending');
            
            // Ø±ÛŒØ³Øªâ€ŒÚ©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
            window.testData = {};
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
            document.getElementById('start-btn').disabled = false;
            document.getElementById('step-btn').disabled = true;
            document.getElementById('scenario-status').className = 'scenario-status status-pending';
            document.getElementById('scenario-status').textContent = 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø´Ø±ÙˆØ¹';
            
            document.getElementById('test-user').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ...';
            document.getElementById('test-lesson').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªØ®Ø§Ø¨...';
            document.getElementById('test-amount').textContent = '0 Ø±ÛŒØ§Ù„';
            document.getElementById('test-score').textContent = '0';
            document.getElementById('test-level').textContent = 'Ù…Ø¨ØªØ¯ÛŒ';
            
            renderTimeline();
            updateStats();
            
            logger.info('âœ… ØªØ³Øª Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø¬Ø¯Ø¯ Ø§Ø³Øª');
        }

        // ========== Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ù†Ø³ÙˆÙ„ ==========
        function clearConsole() {
            document.getElementById('console-output').innerHTML = `
                <div class="log-entry log-info">ğŸ§¹ Ú©Ù†Ø³ÙˆÙ„ Ù¾Ø§Ú© Ø´Ø¯</div>
                <div class="log-entry log-info">ğŸš€ Ø³ÛŒØ³ØªÙ… ØªØ³Øª End-to-End Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§ Ø§Ø³Øª</div>
            `;
        }

        // ========== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ==========
        document.addEventListener('DOMContentLoaded', () => {
            renderTimeline();
            updateStats();
            logger.info('âœ… Ø³ÛŒØ³ØªÙ… ØªØ³Øª End-to-End Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯');
            logger.info('ğŸ‘† Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ú¯Ø±Ø¯Ø´ Ú©Ø§Ù…Ù„" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯');
        });
    </script>
</body>
  </html>
