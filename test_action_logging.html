<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Action Logging - Vakamova</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø¨Ø§ Ø§ØµÙ„Ø§Ø­Ø§Øª */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .badge {
            background: #10b981;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 20px;
            padding: 20px;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .sidebar {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            min-height: 400px;
            overflow: visible;
        }
        
        .test-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .test-btn {
            background: white;
            border: 2px solid #4f46e5;
            color: #4f46e5;
            padding: 12px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
        }
        
        .test-btn:hover {
            background: #4f46e5;
            color: white;
            transform: translateY(-2px);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .stat-box {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        .test-results {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .test-result {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #f59e0b;
            background: white;
        }
        
        .test-result.passed {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        
        .test-result.failed {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        
        .log-viewer {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        /* Ø¨Ø§Ù‚ÛŒ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„ */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <span>ğŸ“ ØªØ³Øª Action Logging</span>
                <span class="badge">Vakamova</span>
            </h1>
            <p>Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù„Ø§Ú¯ Ø¹Ù…Ù„ÛŒØ§Øª</p>
        </header>
        
        <div class="main-content">
            <div class="sidebar">
                <h3>ğŸƒ ØªØ³Øªâ€ŒÙ‡Ø§</h3>
                <div class="test-controls">
                    <button class="test-btn" onclick="runTest(1)">Û±. Ø³Ø§Ø®Øª Logger</button>
                    <button class="test-btn" onclick="runTest(2)">Û². Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ LogÙ‡Ø§</button>
                    <button class="test-btn" onclick="runTest(3)">Û³. ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬Ùˆ</button>
                    <button class="test-btn" onclick="runTest(4)">Û´. Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ LogÙ‡Ø§</button>
                    <button class="test-btn" onclick="runTest(5)">Ûµ. Import/Export</button>
                    <button class="test-btn" onclick="runTest(6)">Û¶. Performance</button>
                    <button class="test-btn" onclick="runTest(7)">Û·. ØªØ³Øª Ø¬Ø§Ù…Ø¹</button>
                    <button class="test-btn" onclick="runAllTests()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none;">
                        â–¶ï¸ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§
                    </button>
                </div>
                
                <div class="stats">
                    <div class="stat-box">
                        <div class="stat-value" id="total-tests">7</div>
                        <div class="stat-label">Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="passed-tests">0</div>
                        <div class="stat-label">Ù…ÙˆÙÙ‚</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="failed-tests">0</div>
                        <div class="stat-label">Ù†Ø§Ù…ÙˆÙÙ‚</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="success-rate">0%</div>
                        <div class="stat-label">Ù…ÙˆÙÙ‚ÛŒØª</div>
                    </div>
                </div>
            </div>
            
            <div class="test-results" id="test-results">
                <!-- Ù†ØªØ§ÛŒØ¬ ØªØ³Øªâ€ŒÙ‡Ø§ -->
            </div>
        </div>
        
        <div class="log-viewer">
            <h3>ğŸ“‹ Live Log Viewer</h3>
            <div class="log-entries" id="log-entries">
                <div class="log-entry">
                    <span class="log-time">--:--:--</span>
                    <span class="log-level info">INFO</span>
                    <span>Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§...</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== Ø³ÛŒØ³ØªÙ… Action Logging (Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡) ====================
        class ActionLogger {
            constructor(maxLogs = 1000, autoSave = true) {
                this.maxLogs = maxLogs;
                this.autoSave = autoSave;
                this.logs = [];
                this.listeners = [];
                this.loadFromStorage();
            }
            
            log(action, data = {}, level = 'info') {
                const logEntry = {
                    id: `log_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                    timestamp: Date.now(),
                    action: action,
                    data: this._sanitizeData(data),
                    level: level,
                    sessionId: this._getSessionId()
                };
                
                this.logs.unshift(logEntry);
                
                // Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯
                if (this.logs.length > this.maxLogs) {
                    this.logs = this.logs.slice(0, this.maxLogs);
                }
                
                if (this.autoSave) {
                    this.saveToStorage();
                }
                
                this._notifyListeners(logEntry);
                this._updateLiveLog(logEntry);
                
                return logEntry;
            }
            
            getLogs(filter = {}) {
                let filteredLogs = [...this.logs];
                
                if (filter.level) {
                    filteredLogs = filteredLogs.filter(log => log.level === filter.level);
                }
                
                if (filter.startDate && filter.endDate) {
                    filteredLogs = filteredLogs.filter(log => 
                        log.timestamp >= filter.startDate && 
                        log.timestamp <= filter.endDate
                    );
                }
                
                if (filter.action) {
                    filteredLogs = filteredLogs.filter(log => 
                        log.action.toLowerCase().includes(filter.action.toLowerCase())
                    );
                }
                
                if (filter.searchText) {
                    filteredLogs = filteredLogs.filter(log => 
                        JSON.stringify(log).toLowerCase().includes(filter.searchText.toLowerCase())
                    );
                }
                
                if (filter.limit) {
                    filteredLogs = filteredLogs.slice(0, filter.limit);
                }
                
                return filteredLogs;
            }
            
            clearLogs(olderThan = null) {
                const initialCount = this.logs.length;
                
                if (olderThan) {
                    const cutoffTime = Date.now() - olderThan;
                    this.logs = this.logs.filter(log => log.timestamp >= cutoffTime);
                } else {
                    this.logs = [];
                }
                
                this.saveToStorage();
                return this.logs.length; // ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡
            }
            
            // ========== Ø§ØµÙ„Ø§Ø­Ø§Øª Ø¯Ø± ØªØ³Øªâ€ŒÙ‡Ø§ ==========
            
            // Ø¨Ù‚ÛŒÙ‡ Ù…ØªØ¯Ù‡Ø§ Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„...
        }

        // ==================== ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ ====================
        const tests = [
            {
                id: 1,
                name: 'Ø³Ø§Ø®Øª Logger',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ØµØ­ÛŒØ­ ActionLogger',
                run: async () => {
                    const logger = new ActionLogger();
                    
                    if (!logger.logs || !Array.isArray(logger.logs)) {
                        throw new Error('ÙÛŒÙ„Ø¯ logs Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´Ø¯Ù‡');
                    }
                    
                    if (logger.maxLogs !== 1000) {
                        throw new Error(`maxLogs Ø¨Ø§ÛŒØ¯ 1000 Ø¨Ø§Ø´Ø¯ØŒ Ø§Ù…Ø§ ${logger.maxLogs} Ø§Ø³Øª`);
                    }
                    
                    return 'âœ… Logger Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯';
                }
            },
            {
                id: 2,
                name: 'Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ LogÙ‡Ø§',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ø«Ø¨Øª Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§',
                run: async () => {
                    const logger = new ActionLogger(50);
                    
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
                    logger.clearLogs();
                    
                    // Ø«Ø¨Øª Ûµ Ù„Ø§Ú¯ ØªØ³ØªÛŒ
                    const testLogs = [
                        { action: 'user_login', data: { userId: '123' }, level: 'info' },
                        { action: 'payment', data: { amount: 50000 }, level: 'success' },
                        { action: 'lesson_completed', data: { score: 95 }, level: 'info' },
                        { action: 'error', data: { code: 'NETWORK' }, level: 'error' },
                        { action: 'warning', data: { type: 'LOW_BATTERY' }, level: 'warn' }
                    ];
                    
                    // Ø«Ø¨Øª Ù„Ø§Ú¯â€ŒÙ‡Ø§
                    testLogs.forEach(log => {
                        logger.log(log.action, log.data, log.level);
                    });
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ¹Ø¯Ø§Ø¯
                    if (logger.logs.length !== 5) {
                        throw new Error(`ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ ${logger.logs.length} Ø§Ø³Øª (Ø§Ù†ØªØ¸Ø§Ø±: 5)`);
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ±ØªÛŒØ¨ (Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ø§ÙˆÙ„)
                    const lastAction = logger.logs[0].action;
                    if (lastAction !== 'warning') {
                        throw new Error(`Ø¢Ø®Ø±ÛŒÙ† Ù„Ø§Ú¯ Ø¨Ø§ÛŒØ¯ 'warning' Ø¨Ø§Ø´Ø¯ØŒ Ø§Ù…Ø§ '${lastAction}' Ø§Ø³Øª`);
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª maxLogs
                    for (let i = 0; i < 60; i++) {
                        logger.log(`test_${i}`, { index: i });
                    }
                    
                    if (logger.logs.length > 50) {
                        throw new Error(`maxLogs Ø±Ø¹Ø§ÛŒØª Ù†Ø´Ø¯Ù‡: ${logger.logs.length} Ù„Ø§Ú¯`);
                    }
                    
                    return `âœ… ${logger.logs.length} Ù„Ø§Ú¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯Ù†Ø¯`;
                }
            },
            {
                id: 3,
                name: 'ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬Ùˆ',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ø³ÛŒØ³ØªÙ… ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡',
                run: async () => {
                    const logger = new ActionLogger();
                    logger.clearLogs();
                    
                    // Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ ØªØ³ØªÛŒ
                    const now = Date.now();
                    const testData = [
                        { action: 'login', level: 'info', data: { user: 'ali' } },
                        { action: 'payment', level: 'success', data: { amount: 10000 } },
                        { action: 'error_network', level: 'error', data: { code: 500 } },
                        { action: 'login', level: 'info', data: { user: 'reza' } },
                        { action: 'logout', level: 'info', data: {} }
                    ];
                    
                    testData.forEach((log, i) => {
                        logger.logs.unshift({
                            id: `test_${i}`,
                            timestamp: now - (i * 1000),
                            action: log.action,
                            data: log.data,
                            level: log.level,
                            sessionId: 'test'
                        });
                    });
                    
                    // ØªØ³Øª ÙÛŒÙ„ØªØ± level
                    const errors = logger.getLogs({ level: 'error' });
                    if (errors.length !== 1) {
                        throw new Error(`ØªØ¹Ø¯Ø§Ø¯ Ø®Ø·Ø§Ù‡Ø§ ${errors.length} Ø§Ø³Øª (Ø§Ù†ØªØ¸Ø§Ø±: 1)`);
                    }
                    
                    // ØªØ³Øª Ø¬Ø³ØªØ¬Ùˆ
                    const loginLogs = logger.getLogs({ action: 'login' });
                    if (loginLogs.length !== 2) {
                        throw new Error(`ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ login ${loginLogs.length} Ø§Ø³Øª (Ø§Ù†ØªØ¸Ø§Ø±: 2)`);
                    }
                    
                    // ØªØ³Øª limit
                    const limited = logger.getLogs({ limit: 2 });
                    if (limited.length !== 2) {
                        throw new Error(`ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ø´Ø¯Ù‡ ${limited.length} Ø§Ø³Øª (Ø§Ù†ØªØ¸Ø§Ø±: 2)`);
                    }
                    
                    return 'âœ… ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬Ùˆ ØµØ­ÛŒØ­ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯';
                }
            },
            {
                id: 4,
                name: 'Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ LogÙ‡Ø§',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ùˆ Ú©Ø§Ù…Ù„',
                run: async () => {
                    const logger = new ActionLogger();
                    logger.clearLogs();
                    
                    // Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
                    const now = Date.now();
                    const oneDay = 24 * 60 * 60 * 1000;
                    
                    // Û³ Ù„Ø§Ú¯ Ù‚Ø¯ÛŒÙ…ÛŒ (Ø¨ÛŒØ´ Ø§Ø² Û² Ø±ÙˆØ²)
                    logger.logs = [
                        { id: 'old1', timestamp: now - (oneDay * 3), action: 'old', level: 'info', data: {}, sessionId: 'test' },
                        { id: 'old2', timestamp: now - (oneDay * 4), action: 'old', level: 'info', data: {}, sessionId: 'test' },
                        { id: 'old3', timestamp: now - (oneDay * 5), action: 'old', level: 'info', data: {}, sessionId: 'test' }
                    ];
                    
                    // Û² Ù„Ø§Ú¯ Ø¬Ø¯ÛŒØ¯ (Ú©Ù…ØªØ± Ø§Ø² Û² Ø±ÙˆØ²)
                    logger.log('new1', { test: 1 });
                    logger.log('new2', { test: 2 });
                    
                    // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ± Ø§Ø² Û² Ø±ÙˆØ²
                    const remaining = logger.clearLogs(oneDay * 2);
                    
                    // Ø¨Ø§ÛŒØ¯ Û² Ù„Ø§Ú¯ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ù‚ÛŒ Ø¨Ù…Ø§Ù†Ø¯
                    if (remaining !== 2) {
                        throw new Error(`Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ ${remaining} Ù„Ø§Ú¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡ (Ø§Ù†ØªØ¸Ø§Ø±: 2)`);
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù† Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                    const remainingActions = logger.logs.map(log => log.action);
                    if (!remainingActions.includes('new1') || !remainingActions.includes('new2')) {
                        throw new Error('Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù†Ø¯');
                    }
                    
                    // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„
                    logger.clearLogs();
                    if (logger.logs.length !== 0) {
                        throw new Error(`Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ ${logger.logs.length} Ù„Ø§Ú¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡`);
                    }
                    
                    return 'âœ… Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ ØµØ­ÛŒØ­ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯';
                }
            },
            {
                id: 5,
                name: 'Import/Export',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ',
                run: async () => {
                    const logger = new ActionLogger();
                    logger.clearLogs();
                    
                    // Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ ØªØ³ØªÛŒ
                    logger.log('export_test_1', { data: 'test1' }, 'info');
                    logger.log('export_test_2', { data: 'test2' }, 'success');
                    
                    // Export Ø¨Ù‡ JSON
                    const json = logger.exportLogs('json');
                    if (!json.includes('export_test_1')) {
                        throw new Error('Export JSON Ø´Ø§Ù…Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù†ÛŒØ³Øª');
                    }
                    
                    // Import Ø¨Ù‡ logger Ø¬Ø¯ÛŒØ¯
                    const newLogger = new ActionLogger();
                    newLogger.clearLogs();
                    const importedCount = newLogger.importLogs(json);
                    
                    if (importedCount !== 2) {
                        throw new Error(`${importedCount} Ù„Ø§Ú¯ ÙˆØ§Ø±Ø¯ Ø´Ø¯ (Ø§Ù†ØªØ¸Ø§Ø±: 2)`);
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    if (newLogger.logs.length !== 2) {
                        throw new Error(`${newLogger.logs.length} Ù„Ø§Ú¯ Ø¯Ø± logger Ø¬Ø¯ÛŒØ¯ (Ø§Ù†ØªØ¸Ø§Ø±: 2)`);
                    }
                    
                    return 'âœ… Import/Export Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯';
                }
            },
            {
                id: 6,
                name: 'Performance',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ø§ Ø­Ø¬Ù… Ø¨Ø§Ù„Ø§',
                run: async () => {
                    const logger = new ActionLogger(1000);
                    logger.clearLogs();
                    
                    // ØªØ³Øª Ø³Ø±Ø¹Øª Ø«Ø¨Øª
                    const start = Date.now();
                    const count = 200;
                    
                    for (let i = 0; i < count; i++) {
                        logger.log(`perf_${i}`, { index: i });
                    }
                    
                    const time = Date.now() - start;
                    const avg = time / count;
                    
                    if (avg > 2) {
                        throw new Error(`Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø²Ù…Ø§Ù† Ø«Ø¨Øª ${avg.toFixed(2)}ms Ø§Ø³Øª (Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø²)`);
                    }
                    
                    // ØªØ³Øª Ø¬Ø³ØªØ¬Ùˆ
                    const searchStart = Date.now();
                    const results = logger.getLogs({ searchText: 'perf_100' });
                    const searchTime = Date.now() - searchStart;
                    
                    if (searchTime > 50) {
                        throw new Error(`Ø²Ù…Ø§Ù† Ø¬Ø³ØªØ¬Ùˆ ${searchTime}ms Ø§Ø³Øª (Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø²)`);
                    }
                    
                    return `âœ… Performance Ù…Ù†Ø§Ø³Ø¨ - Ø«Ø¨Øª: ${avg.toFixed(2)}ms, Ø¬Ø³ØªØ¬Ùˆ: ${searchTime}ms`;
                }
            },
            {
                id: 7,
                name: 'ØªØ³Øª Ø¬Ø§Ù…Ø¹',
                description: 'Ø¨Ø±Ø±Ø³ÛŒ ØªÙ…Ø§Ù… Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ Ø¯Ø± Ø³Ù†Ø§Ø±ÛŒÙˆ ÙˆØ§Ù‚Ø¹ÛŒ',
                run: async () => {
                    const logger = new ActionLogger(50);
                    logger.clearLogs();
                    
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ú©Ø§Ø±Ø¨Ø±ÛŒ
                    logger.log('app_start', { version: '1.0' });
                    logger.log('user_login', { user: 'test_user' }, 'success');
                    logger.log('lesson_start', { lesson: 'L101' });
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§
                    if (logger.logs.length !== 3) {
                        throw new Error(`${logger.logs.length} Ù„Ø§Ú¯ Ø«Ø¨Øª Ø´Ø¯Ù‡ (Ø§Ù†ØªØ¸Ø§Ø±: 3)`);
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ listener
                    let listenerFired = false;
                    logger.addListener(() => {
                        listenerFired = true;
                    });
                    
                    logger.log('test_event', {});
                    
                    if (!listenerFired) {
                        throw new Error('Listener Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Live Log
                    const liveLogs = document.getElementById('log-entries');
                    if (!liveLogs || liveLogs.children.length < 1) {
                        throw new Error('Live Log Viewer Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ù…Ø§Ø±
                    const stats = logger.getStatistics();
                    if (stats.totalLogs < 4) {
                        throw new Error(`Ø¢Ù…Ø§Ø±: ${stats.totalLogs} Ù„Ø§Ú¯ (Ø­Ø¯Ø§Ù‚Ù„ Û´ Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÛŒâ€ŒØ±ÙØª)`);
                    }
                    
                    return 'âœ… ØªØ³Øª Ø¬Ø§Ù…Ø¹ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯';
                }
            }
        ];

        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª ØªØ³Øªâ€ŒÙ‡Ø§ ====================
        const TestManager = {
            results: [],
            
            displayResult(testId, success, message) {
                const resultsDiv = document.getElementById('test-results');
                const resultDiv = document.createElement('div');
                
                resultDiv.className = `test-result ${success ? 'passed' : 'failed'}`;
                resultDiv.innerHTML = `
                    <h4>
                        <span>${testId}. ${tests.find(t => t.id === testId).name}</span>
                        <span class="status-badge">${success ? 'âœ… Ù…ÙˆÙÙ‚' : 'âŒ Ù†Ø§Ù…ÙˆÙÙ‚'}</span>
                    </h4>
                    <p>${tests.find(t => t.id === testId).description}</p>
                    <div class="test-output">${message}</div>
                `;
                
                resultsDiv.appendChild(resultDiv);
                this.results[testId] = success;
                this.updateStats();
                
                // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†
                resultDiv.scrollIntoView({ behavior: 'smooth' });
            },
            
            async runTest(testId) {
                const test = tests.find(t => t.id === testId);
                if (!test) return;
                
                try {
                    const result = await test.run();
                    this.displayResult(testId, true, result);
                    
                    // Ø«Ø¨Øª Ù„Ø§Ú¯
                    if (window.logger) {
                        window.logger.log(`test_${testId}_passed`, { test: test.name }, 'success');
                    }
                    
                } catch (error) {
                    this.displayResult(testId, false, error.message);
                    
                    // Ø«Ø¨Øª Ù„Ø§Ú¯ Ø®Ø·Ø§
                    if (window.logger) {
                        window.logger.log(`test_${testId}_failed`, { 
                            test: test.name,
                            error: error.message 
                        }, 'error');
                    }
                }
            },
            
            async runAllTests() {
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬ Ù‚Ø¨Ù„ÛŒ
                document.getElementById('test-results').innerHTML = '';
                this.results = [];
                
                // Ø§Ø¬Ø±Ø§ÛŒ ØªØ±ØªÛŒØ¨ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§
                for (const test of tests) {
                    await this.runTest(test.id);
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
            },
            
            updateStats() {
                const total = tests.length;
                const passed = this.results.filter(Boolean).length;
                const failed = total - passed;
                const rate = total > 0 ? Math.round((passed / total) * 100) : 0;
                
                document.getElementById('passed-tests').textContent = passed;
                document.getElementById('failed-tests').textContent = failed;
                document.getElementById('success-rate').textContent = `${rate}%`;
            }
        };

        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Ø§ÛŒØ¬Ø§Ø¯ logger
            window.logger = new ActionLogger();
            
            // Ø«Ø¨Øª Ø´Ø±ÙˆØ¹
            logger.log('testing_started', { 
                testSuite: 'Action Logging',
                timestamp: new Date().toISOString() 
            }, 'info');
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            TestManager.updateStats();
        });

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø¹Ù…ÙˆÙ…ÛŒ ====================
        function runTest(testId) {
            TestManager.runTest(testId);
        }
        
        function runAllTests() {
            TestManager.runAllTests();
        }
    </script>
</body>
</html>
