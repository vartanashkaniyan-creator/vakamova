<!-- test.html -->
<!DOCTYPE html>
<html dir="rtl">
<head>
    <title>ØªØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Vakamova</title>
    <style>
        body { font-family: Tahoma; margin: 20px; }
        button { padding: 15px; margin: 5px; background: #2d5be3; color: white; border: none; border-radius: 5px; }
        .success { color: green; padding: 10px; background: #e8f5e9; margin: 5px 0; }
        .error { color: red; padding: 10px; background: #ffebee; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>ğŸ”„ ØªØ³Øª Ø§ØªØµØ§Ù„ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Vakamova</h1>
    <button onclick="runAllTests()">ğŸ¯ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</button>
    <button onclick="testAuth()">ğŸ” ØªØ³Øª Ù…Ø§Ú˜ÙˆÙ„ auth</button>
    <button onclick="testCore()">âš™ï¸ ØªØ³Øª Ù…Ø§Ú˜ÙˆÙ„ core</button>
    <div id="results"></div>

    <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ…Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ -->
    <script src="core/utils.js"></script>
    <script src="core/event_bus.js"></script>
    <script src="core/state.manager.js"></script>
    <script src="modules/auth/auth.manager.js"></script>
    <script src="modules/auth/token.manager.js"></script>
    <!-- Ø¨Ù‚ÛŒÙ‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ù‡ Ù‡Ù…ÛŒÙ† ØªØ±ØªÛŒØ¨ -->

    <script>
        const results = document.getElementById('results');
        
        function logTest(module, message, isSuccess) {
            const div = document.createElement('div');
            div.className = isSuccess ? 'success' : 'error';
            div.innerHTML = `<strong>${module}:</strong> ${message}`;
            results.appendChild(div);
        }

        function testAuth() {
            results.innerHTML = '<h3>ğŸ” Ù†ØªØ§ÛŒØ¬ ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª:</h3>';
            try {
                if (typeof authManager !== 'undefined') {
                    logTest('auth.manager', 'ÙØ§ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù„ÙˆØ¯ Ø´Ø¯', true);
                    
                    // ØªØ³Øª ØªÙˆØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ
                    const methods = ['login', 'register', 'logout'];
                    methods.forEach(method => {
                        if (typeof authManager[method] === 'function') {
                            logTest('auth.manager', `ØªØ§Ø¨Ø¹ ${method}() ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯`, true);
                        } else {
                            logTest('auth.manager', `ØªØ§Ø¨Ø¹ ${method}() ÛŒØ§ÙØª Ù†Ø´Ø¯`, false);
                        }
                    });
                } else {
                    logTest('auth.manager', 'ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ù†Ø´Ø¯', false);
                }
            } catch (error) {
                logTest('auth.manager', `Ø®Ø·Ø§: ${error.message}`, false);
            }
        }

        function testCore() {
            results.innerHTML = '<h3>âš™ï¸ Ù†ØªØ§ÛŒØ¬ ØªØ³Øª core:</h3>';
            // ØªØ³Øª state.manager
            if (typeof stateManager !== 'undefined') {
                logTest('state.manager', 'ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ø´Ø¯', true);
                // ØªØ³Øª ØªØºÛŒÛŒØ± state
                try {
                    stateManager.setState('test', 'value');
                    const val = stateManager.getState('test');
                    logTest('state.manager', `Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ state: ${val}`, val === 'value');
                } catch (e) {
                    logTest('state.manager', `Ø®Ø·Ø§ Ø¯Ø± state: ${e.message}`, false);
                }
            }
        }

        function runAllTests() {
            results.innerHTML = '<h2>ğŸ¯ Ø¯Ø±Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§...</h2>';
            setTimeout(() => {
                testCore();
                testAuth();
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
                logTest('Ø³ÛŒØ³ØªÙ…', 'ØªØ³Øªâ€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯Ù†Ø¯', true);
            }, 500);
        }
    </script>
</body>
</html>
